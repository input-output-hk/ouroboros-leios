<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Leios.Short</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel="stylesheet" href="Agda.css" />
</head>
<body>
             <div class="agda-header">
               <div class="agda-header-left">
                 <a href="/formal-spec/">Back</a>
                 <button class="search-button" onclick="toggleSearch()">
                   <svg viewBox="0 0 24 24" width="24" height="24">
                     <path fill="currentColor" d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
                   </svg>
                   Search...
                 </button>
               </div>
               <div class="agda-header-right">
                 <a href="https://github.com/input-output-hk/ouroboros-leios-formal-spec" class="github-link" target="_blank" rel="noopener noreferrer" title="View on GitHub">
                   <svg viewBox="0 0 24 24" width="24" height="24">
                     <path fill="currentColor" d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                   </svg>
                 </a>
                 <button class="theme-toggle" onclick="toggleTheme()" title="Toggle theme">
                   <span class="light-icon">
                     <svg viewBox="0 0 24 24" width="24" height="24">
                       <path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path>
                     </svg>
                   </span>
                   <span class="dark-icon">
                     <svg viewBox="0 0 24 24" width="24" height="24">
                       <path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path>
                     </svg>
                   </span>
                 </button>
               </div>
             </div>
             <div class="search-overlay">
               <div class="search-modal">
                 <div class="search-container">
                   <input type="text" class="search-input" placeholder="Search modules..." />
                   <div class="search-results"></div>
                 </div>
               </div>
             </div>
             <div class="agda-container">
               <nav class="agda-sidebar">
                 <h3>Modules</h3>
                 
                     <h4>Leios</h4>
                     <ul>
                       <li><a href="/agda_html/Leios.Abstract.html" >Abstract</a></li>
<li><a href="/agda_html/Leios.Base.html" >Base</a></li>
<li><a href="/agda_html/Leios.Blocks.html" >Blocks</a></li>
<li><a href="/agda_html/Leios.Config.html" >Config</a></li>
<li><a href="/agda_html/Leios.Defaults.html" >Defaults</a></li>
<li><a href="/agda_html/Leios.FFD.html" >FFD</a></li>
<li><a href="/agda_html/Leios.Foreign.BaseTypes.html" >Foreign.BaseTypes</a></li>
<li><a href="/agda_html/Leios.Foreign.HsTypes.html" >Foreign.HsTypes</a></li>
<li><a href="/agda_html/Leios.Foreign.Types.html" >Foreign.Types</a></li>
<li><a href="/agda_html/Leios.Foreign.Util.html" >Foreign.Util</a></li>
<li><a href="/agda_html/Leios.KeyRegistration.html" >KeyRegistration</a></li>
<li><a href="/agda_html/Leios.Network.html" >Network</a></li>
<li><a href="/agda_html/Leios.Prelude.html" >Prelude</a></li>
<li><a href="/agda_html/Leios.Protocol.html" >Protocol</a></li>
<li><a href="/agda_html/Leios.Short.html" class="active">Short</a></li>
<li><a href="/agda_html/Leios.Short.Decidable.html" >Short.Decidable</a></li>
<li><a href="/agda_html/Leios.Short.Trace.Verifier.html" >Short.Trace.Verifier</a></li>
<li><a href="/agda_html/Leios.Short.Trace.Verifier.Test.html" >Short.Trace.Verifier.Test</a></li>
<li><a href="/agda_html/Leios.Simplified.html" >Simplified</a></li>
<li><a href="/agda_html/Leios.Simplified.Deterministic.html" >Simplified.Deterministic</a></li>
<li><a href="/agda_html/Leios.SpecStructure.html" >SpecStructure</a></li>
<li><a href="/agda_html/Leios.Traces.html" >Traces</a></li>
<li><a href="/agda_html/Leios.Voting.html" >Voting</a></li>
<li><a href="/agda_html/Leios.VRF.html" >VRF</a></li>
                     </ul>
                   
               </nav>
               <main class="agda-content">
             <script src="agda.js"></script>
<h2 id="short-pipeline-leios">Short-Pipeline Leios</h2>
<!--
<pre class="Agda"><div class="line"><a id="39" class="Symbol">{-#</a> <a id="43" class="Keyword">OPTIONS</a> <a id="51" class="Pragma">--safe</a> <a id="58" class="Symbol">#-}</a></div>
<div class="line"><a id="62" class="Keyword">open</a> <a id="67" class="Keyword">import</a> <a id="74" href="/agda_html/Leios.Prelude.html" class="Module">Leios.Prelude</a> <a id="88" class="Keyword">hiding</a> <a id="95" class="Symbol">(</a><a id="96" href="/agda_html/Function.Base.html#704" class="Function">id</a><a id="98" class="Symbol">)</a></div>
<div class="line"><a id="100" class="Keyword">open</a> <a id="105" class="Keyword">import</a> <a id="112" href="/agda_html/Leios.FFD.html" class="Module">Leios.FFD</a></div>
<div class="line"><a id="122" class="Keyword">open</a> <a id="127" class="Keyword">import</a> <a id="134" href="/agda_html/Leios.SpecStructure.html" class="Module">Leios.SpecStructure</a></div>
<div class="line"><a id="154" class="Keyword">open</a> <a id="159" class="Keyword">import</a> <a id="166" href="/agda_html/Data.Fin.Patterns.html" class="Module">Data.Fin.Patterns</a></div>
<div class="line"><a id="184" class="Keyword">open</a> <a id="189" class="Keyword">import</a> <a id="196" href="/agda_html/Class.ToBool.html" class="Module">Class.ToBool</a></div>
<div class="line"></div>
<div class="line"><a id="210" class="Keyword">open</a> <a id="215" class="Keyword">import</a> <a id="222" href="/agda_html/Tactic.Defaults.html" class="Module">Tactic.Defaults</a></div>
<div class="line"><a id="238" class="Keyword">open</a> <a id="243" class="Keyword">import</a> <a id="250" href="/agda_html/Tactic.Derive.DecEq.html" class="Module">Tactic.Derive.DecEq</a></div>
<div class="line"></div>
<div class="line"><a id="271" class="Keyword">module</a> <a id="278" href="/agda_html/Leios.Short.html" class="Module">Leios.Short</a> <a id="290" class="Symbol">(</a><a id="291" href="/agda_html/Leios.Short.html#291" class="Bound">⋯</a> <a id="293" class="Symbol">:</a> <a id="295" href="/agda_html/Leios.SpecStructure.html#286" class="Record">SpecStructure</a> <a id="309" class="Number">1</a><a id="310" class="Symbol">)</a></div>
<div class="line">  <a id="314" class="Symbol">(</a><a id="315" class="Keyword">let</a> <a id="319" class="Keyword">open</a> <a id="324" href="/agda_html/Leios.SpecStructure.html#286" class="Module">SpecStructure</a> <a id="338" href="/agda_html/Leios.Short.html#291" class="Bound">⋯</a> <a id="340" class="Keyword">renaming</a> <a id="349" class="Symbol">(</a><a id="350" href="/agda_html/Leios.Voting.html#203" class="Function">isVoteCertified</a> <a id="366" class="Symbol">to</a> <a id="369" class="Function">isVoteCertified&#39;</a><a id="385" class="Symbol">))</a> <a id="388" class="Keyword">where</a></div>
<div class="line"></div></pre>-->
<p>This document is a specification of Short-Pipeline Leios, usually
abbreviated as Short Leios. On a high level, the pipeline looks like
this:</p>
<ol type="1">
<li>If elected, propose IB</li>
<li>Wait</li>
<li>Wait</li>
<li>If elected, propose EB</li>
<li>If elected, vote If elected, propose RB</li>
</ol>
<h3 id="upkeep">Upkeep</h3>
<p>A node that never produces a block even though it could is not
supposed to be an honest node, and we prevent that by tracking whether a
node has checked if it can make a block in a particular slot.
<code>LeiosState</code> contains a set of <code>SlotUpkeep</code> and we
ensure that this set contains all elements before we can advance to the
next slot, resetting this field to the empty set.</p>
<pre class="Agda"><div class="line"><a id="1052" class="Keyword">data</a> <a id="SlotUpkeep"></a><a id="1057" href="/agda_html/Leios.Short.html#1057" class="Datatype">SlotUpkeep</a> <a id="1068" class="Symbol">:</a> <a id="1070" href="/agda_html/Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1075" class="Keyword">where</a></div>
<div class="line">  <a id="SlotUpkeep.Base"></a><a id="1083" href="/agda_html/Leios.Short.html#1083" class="InductiveConstructor">Base</a> <a id="SlotUpkeep.IB-Role"></a><a id="1088" href="/agda_html/Leios.Short.html#1088" class="InductiveConstructor">IB-Role</a> <a id="SlotUpkeep.EB-Role"></a><a id="1096" href="/agda_html/Leios.Short.html#1096" class="InductiveConstructor">EB-Role</a> <a id="SlotUpkeep.VT-Role"></a><a id="1104" href="/agda_html/Leios.Short.html#1104" class="InductiveConstructor">VT-Role</a> <a id="1112" class="Symbol">:</a> <a id="1114" href="/agda_html/Leios.Short.html#1057" class="Datatype">SlotUpkeep</a></div>
<div class="line"></div></pre>
<!--
<pre class="Agda"><div class="line"><a id="1142" class="Keyword">unquoteDecl</a> <a id="DecEq-SlotUpkeep"></a><a id="1154" href="/agda_html/Leios.Short.html#1154" class="Function">DecEq-SlotUpkeep</a> <a id="1171" class="Symbol">=</a> <a id="1173" href="/agda_html/Tactic.Derive.DecEq.html#3512" class="Function">derive-DecEq</a> <a id="1186" class="Symbol">((</a><a id="1188" class="Keyword">quote</a> <a id="1194" href="/agda_html/Leios.Short.html#1057" class="Datatype">SlotUpkeep</a> <a id="1205" href="/agda_html/Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1207" href="/agda_html/Leios.Short.html#1154" class="Function">DecEq-SlotUpkeep</a><a id="1223" class="Symbol">)</a> <a id="1225" href="/agda_html/Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1227" href="/agda_html/Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="1229" class="Symbol">)</a></div>
<div class="line"></div>
<div class="line"><a id="1232" class="Keyword">open</a> <a id="1237" class="Keyword">import</a> <a id="1244" href="/agda_html/Leios.Protocol.html" class="Module">Leios.Protocol</a> <a id="1259" class="Symbol">(</a><a id="1260" href="/agda_html/Leios.Short.html#291" class="Bound">⋯</a><a id="1261" class="Symbol">)</a> <a id="1263" href="/agda_html/Leios.Short.html#1057" class="Datatype">SlotUpkeep</a> <a id="1274" class="Keyword">public</a></div>
<div class="line"><a id="1281" class="Keyword">open</a> <a id="1286" href="/agda_html/Leios.Base.html#389" class="Module">BaseAbstract</a> <a id="1299" href="/agda_html/Leios.SpecStructure.html#835" class="Field">B&#39;</a> <a id="1302" class="Keyword">using</a> <a id="1308" class="Symbol">(</a><a id="1309" href="/agda_html/Leios.Base.html#424" class="Field">Cert</a><a id="1313" class="Symbol">;</a> <a id="1315" href="/agda_html/Leios.Base.html#490" class="Field">V-chkCerts</a><a id="1325" class="Symbol">;</a> <a id="1327" href="/agda_html/Leios.Base.html#444" class="Field">VTy</a><a id="1330" class="Symbol">;</a> <a id="1332" href="/agda_html/Leios.Base.html#463" class="Field">initSlot</a><a id="1340" class="Symbol">)</a></div>
<div class="line"><a id="1342" class="Keyword">open</a> <a id="1347" href="/agda_html/Leios.SpecStructure.html#1203" class="Module">FFD</a> <a id="1351" class="Keyword">hiding</a> <a id="1358" class="Symbol">(</a><a id="1359" href="/agda_html/Leios.FFD.html#562" class="Function Operator">_-⟦_/_⟧⇀_</a><a id="1368" class="Symbol">)</a></div>
<div class="line"><a id="1370" class="Keyword">open</a> <a id="1375" href="/agda_html/Leios.Blocks.html#4246" class="Module">GenFFD</a></div>
<div class="line"></div></pre><pre class="Agda"><div class="line"><a id="isVoteCertified"></a><a id="1394" href="/agda_html/Leios.Short.html#1394" class="Function">isVoteCertified</a> <a id="1410" class="Symbol">:</a> <a id="1412" href="/agda_html/Leios.Protocol.html#959" class="Record">LeiosState</a> <a id="1423" class="Symbol">→</a> <a id="1425" href="/agda_html/Leios.Blocks.html#2804" class="Function">EndorserBlock</a> <a id="1439" class="Symbol">→</a> <a id="1441" href="/agda_html/Agda.Primitive.html#388" class="Primitive">Type</a></div>
<div class="line"><a id="1446" href="/agda_html/Leios.Short.html#1394" class="Function">isVoteCertified</a> <a id="1462" href="/agda_html/Leios.Short.html#1462" class="Bound">s</a> <a id="1464" href="/agda_html/Leios.Short.html#1464" class="Bound">eb</a> <a id="1467" class="Symbol">=</a> <a id="1469" href="/agda_html/Leios.Short.html#369" class="Function">isVoteCertified&#39;</a> <a id="1486" class="Symbol">(</a><a id="1487" href="/agda_html/Leios.Protocol.html#1419" class="Field">LeiosState.votingState</a> <a id="1510" href="/agda_html/Leios.Short.html#1462" class="Bound">s</a><a id="1511" class="Symbol">)</a> <a id="1513" class="Symbol">(</a><a id="1514" href="/agda_html/Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a> <a id="1517" href="/agda_html/Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1519" href="/agda_html/Leios.Short.html#1464" class="Bound">eb</a><a id="1521" class="Symbol">)</a></div>
<div class="line"></div></pre><pre class="Agda"><div class="line"><a id="1535" class="Keyword">private</a> <a id="1543" class="Keyword">variable</a> <a id="1552" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a> <a id="1554" href="/agda_html/Leios.Short.html#1554" class="Generalizable">s&#39;</a>   <a id="1559" class="Symbol">:</a> <a id="1561" href="/agda_html/Leios.Protocol.html#959" class="Record">LeiosState</a></div>
<div class="line">                 <a id="1589" href="/agda_html/Leios.Short.html#1589" class="Generalizable">ffds&#39;</a>  <a id="1596" class="Symbol">:</a> <a id="1598" href="/agda_html/Leios.FFD.html#508" class="Function">FFD.State</a></div>
<div class="line">                 <a id="1625" href="/agda_html/Leios.Short.html#1625" class="Generalizable">π</a>      <a id="1632" class="Symbol">:</a> <a id="1634" href="/agda_html/Leios.Abstract.html#245" class="Function">VrfPf</a></div>
<div class="line">                 <a id="1657" href="/agda_html/Leios.Short.html#1657" class="Generalizable">bs&#39;</a>    <a id="1664" class="Symbol">:</a> <a id="1666" href="/agda_html/Leios.Base.html#847" class="Function">B.State</a></div>
<div class="line">                 <a id="1691" href="/agda_html/Leios.Short.html#1691" class="Generalizable">ks</a> <a id="1694" href="/agda_html/Leios.Short.html#1694" class="Generalizable">ks&#39;</a> <a id="1698" class="Symbol">:</a> <a id="1700" href="/agda_html/Leios.KeyRegistration.html#453" class="Function">K.State</a></div>
<div class="line">                 <a id="1725" href="/agda_html/Leios.Short.html#1725" class="Generalizable">msgs</a>   <a id="1732" class="Symbol">:</a> <a id="1734" href="/agda_html/Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1739" class="Symbol">(</a><a id="1740" href="/agda_html/Leios.FFD.html#117" class="Field">FFDAbstract.Header</a> <a id="1759" href="/agda_html/Leios.Blocks.html#5294" class="Function">ffdAbstract</a> <a id="1771" href="/agda_html/Data.Sum.Base.html#625" class="Datatype Operator">⊎</a> <a id="1773" href="/agda_html/Leios.FFD.html#124" class="Field">FFDAbstract.Body</a> <a id="1790" href="/agda_html/Leios.Blocks.html#5294" class="Function">ffdAbstract</a><a id="1801" class="Symbol">)</a></div>
<div class="line">                 <a id="1820" href="/agda_html/Leios.Short.html#1820" class="Generalizable">eb</a>     <a id="1827" class="Symbol">:</a> <a id="1829" href="/agda_html/Leios.Blocks.html#2804" class="Function">EndorserBlock</a></div>
<div class="line">                 <a id="1860" href="/agda_html/Leios.Short.html#1860" class="Generalizable">rbs</a>    <a id="1867" class="Symbol">:</a> <a id="1869" href="/agda_html/Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1874" href="/agda_html/Leios.Base.html#316" class="Function">RankingBlock</a></div>
<div class="line">                 <a id="1904" href="/agda_html/Leios.Short.html#1904" class="Generalizable">txs</a>    <a id="1911" class="Symbol">:</a> <a id="1913" href="/agda_html/Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1918" href="/agda_html/Leios.Abstract.html#124" class="Function">Tx</a></div>
<div class="line">                 <a id="1938" href="/agda_html/Leios.Short.html#1938" class="Generalizable">V</a>      <a id="1945" class="Symbol">:</a> <a id="1947" href="/agda_html/Leios.Base.html#444" class="Function">VTy</a></div>
<div class="line">                 <a id="1968" href="/agda_html/Leios.Short.html#1968" class="Generalizable">SD</a>     <a id="1975" class="Symbol">:</a> <a id="1977" href="/agda_html/Leios.Base.html#266" class="Function">StakeDistr</a></div>
<div class="line">                 <a id="2005" href="/agda_html/Leios.Short.html#2005" class="Generalizable">pks</a>    <a id="2012" class="Symbol">:</a> <a id="2014" href="/agda_html/Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2019" href="/agda_html/Leios.VRF.html#480" class="Function">PubKey</a></div>
<div class="line"></div></pre>-->
<h3 id="blockvote-production-rules">Block/Vote production rules</h3>
<p>We now define the rules for block production given by the relation
<code>_↝_</code>. These are split in two:</p>
<ol type="1">
<li>Positive rules, when we do need to create a block.</li>
<li>Negative rules, when we cannot create a block.</li>
</ol>
<p>The purpose of the negative rules is to properly adjust the upkeep if
we cannot make a block.</p>
<p>Note that <code>_↝_</code>, starting with an empty upkeep can always
make exactly three steps corresponding to the three types of Leios
specific blocks.</p>
<pre class="Agda"><div class="line"><a id="2518" class="Keyword">data</a> <a id="_↝_"></a><a id="2523" href="/agda_html/Leios.Short.html#2523" class="Datatype Operator">_↝_</a> <a id="2527" class="Symbol">:</a> <a id="2529" href="/agda_html/Leios.Protocol.html#959" class="Record">LeiosState</a> <a id="2540" class="Symbol">→</a> <a id="2542" href="/agda_html/Leios.Protocol.html#959" class="Record">LeiosState</a> <a id="2553" class="Symbol">→</a> <a id="2555" href="/agda_html/Agda.Primitive.html#388" class="Primitive">Type</a> <a id="2560" class="Keyword">where</a></div>
<div class="line"></div></pre>
<h4 id="positive-rules">Positive rules</h4>
<pre class="Agda"><div class="line">  <a id="_↝_.IB-Role"></a><a id="2600" href="/agda_html/Leios.Short.html#2600" class="InductiveConstructor">IB-Role</a> <a id="2608" class="Symbol">:</a> <a id="2610" class="Keyword">let</a> <a id="2614" class="Keyword">open</a> <a id="2619" href="/agda_html/Leios.Protocol.html#959" class="Module">LeiosState</a> <a id="2630" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a> <a id="2632" class="Keyword">renaming</a> <a id="2641" class="Symbol">(</a><a id="2642" href="/agda_html/Leios.Protocol.html#1050" class="Field">FFDState</a> <a id="2651" class="Symbol">to</a> <a id="2654" class="Field">ffds</a><a id="2658" class="Symbol">)</a></div>
<div class="line">                <a id="2676" href="/agda_html/Leios.Short.html#2676" class="Bound">b</a> <a id="2678" class="Symbol">=</a> <a id="2680" href="/agda_html/Leios.Blocks.html#4449" class="InductiveConstructor">ibBody</a> <a id="2687" class="Symbol">(</a><a id="2688" class="Keyword">record</a> <a id="2695" class="Symbol">{</a> <a id="2697" href="/agda_html/Leios.Blocks.html#1083" class="Field">txs</a> <a id="2701" class="Symbol">=</a> <a id="2703" href="/agda_html/Leios.Protocol.html#1112" class="Function">ToPropose</a> <a id="2713" class="Symbol">})</a></div>
<div class="line">                <a id="2732" href="/agda_html/Leios.Short.html#2732" class="Bound">h</a> <a id="2734" class="Symbol">=</a> <a id="2736" href="/agda_html/Leios.Blocks.html#4318" class="InductiveConstructor">ibHeader</a> <a id="2745" class="Symbol">(</a><a id="2746" href="/agda_html/Leios.Blocks.html#1898" class="Function">mkIBHeader</a> <a id="2757" href="/agda_html/Leios.Protocol.html#1260" class="Function">slot</a> <a id="2762" href="/agda_html/Leios.SpecStructure.html#601" class="Field">id</a> <a id="2765" href="/agda_html/Leios.Short.html#1625" class="Generalizable">π</a> <a id="2767" href="/agda_html/Leios.SpecStructure.html#730" class="Field">sk-IB</a> <a id="2773" href="/agda_html/Leios.Protocol.html#1112" class="Function">ToPropose</a><a id="2782" class="Symbol">)</a></div>
<div class="line">          <a id="2794" class="Keyword">in</a></div>
<div class="line">          <a id="2807" href="/agda_html/Prelude.InferenceRules.html#56074" class="Function Operator">∙</a> <a id="2809" href="/agda_html/Leios.Protocol.html#2023" class="Function">needsUpkeep</a> <a id="2821" href="/agda_html/Leios.Short.html#1088" class="InductiveConstructor">IB-Role</a></div>
<div class="line">          <a id="2839" href="/agda_html/Prelude.InferenceRules.html#56005" class="Function Operator">∙</a> <a id="2841" href="/agda_html/Leios.VRF.html#814" class="Function">canProduceIB</a> <a id="2854" href="/agda_html/Leios.Protocol.html#1260" class="Function">slot</a> <a id="2859" href="/agda_html/Leios.SpecStructure.html#730" class="Field">sk-IB</a> <a id="2865" class="Symbol">(</a><a id="2866" href="/agda_html/Leios.Protocol.html#2995" class="Function">stake</a> <a id="2872" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a><a id="2873" class="Symbol">)</a> <a id="2875" href="/agda_html/Leios.Short.html#1625" class="Generalizable">π</a></div>
<div class="line">          <a id="2887" href="/agda_html/Prelude.InferenceRules.html#56005" class="Function Operator">∙</a> <a id="2889" href="/agda_html/Leios.Short.html#2654" class="Function">ffds</a> <a id="2894" href="/agda_html/Leios.FFD.html#562" class="Function Operator">FFD.-⟦</a> <a id="2901" href="/agda_html/Leios.FFD.html#311" class="InductiveConstructor">Send</a> <a id="2906" href="/agda_html/Leios.Short.html#2732" class="Bound">h</a> <a id="2908" class="Symbol">(</a><a id="2909" href="/agda_html/Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2914" href="/agda_html/Leios.Short.html#2676" class="Bound">b</a><a id="2915" class="Symbol">)</a> <a id="2917" href="/agda_html/Leios.FFD.html#562" class="Function Operator">/</a> <a id="2919" href="/agda_html/Leios.FFD.html#397" class="InductiveConstructor">SendRes</a> <a id="2927" href="/agda_html/Leios.FFD.html#562" class="Function Operator">⟧⇀</a> <a id="2930" href="/agda_html/Leios.Short.html#1589" class="Generalizable">ffds&#39;</a></div>
<div class="line">          <a id="2946" href="/agda_html/Prelude.InferenceRules.html#11315" class="Function Operator">─────────────────────────────────────────────────────────────────────────</a></div>
<div class="line">          <a id="3030" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a> <a id="3032" href="/agda_html/Leios.Short.html#2523" class="Datatype Operator">↝</a> <a id="3034" href="/agda_html/Leios.Protocol.html#2208" class="Function">addUpkeep</a> <a id="3044" class="Keyword">record</a> <a id="3051" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a> <a id="3053" class="Symbol">{</a> <a id="3055" href="/agda_html/Leios.Protocol.html#1050" class="Field">FFDState</a> <a id="3064" class="Symbol">=</a> <a id="3066" href="/agda_html/Leios.Short.html#1589" class="Generalizable">ffds&#39;</a> <a id="3072" class="Symbol">}</a> <a id="3074" href="/agda_html/Leios.Short.html#1088" class="InductiveConstructor">IB-Role</a></div>
<div class="line"></div></pre>
<pre class="Agda"><div class="line">  <a id="_↝_.EB-Role"></a><a id="3096" href="/agda_html/Leios.Short.html#3096" class="InductiveConstructor">EB-Role</a> <a id="3104" class="Symbol">:</a> <a id="3106" class="Keyword">let</a> <a id="3110" class="Keyword">open</a> <a id="3115" href="/agda_html/Leios.Protocol.html#959" class="Module">LeiosState</a> <a id="3126" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a> <a id="3128" class="Keyword">renaming</a> <a id="3137" class="Symbol">(</a><a id="3138" href="/agda_html/Leios.Protocol.html#1050" class="Field">FFDState</a> <a id="3147" class="Symbol">to</a> <a id="3150" class="Field">ffds</a><a id="3154" class="Symbol">)</a></div>
<div class="line">                <a id="3172" href="/agda_html/Leios.Short.html#3172" class="Bound">LI</a> <a id="3175" class="Symbol">=</a> <a id="3177" href="/agda_html/abstract-set-theory.Prelude.html#1824" class="Function">map</a> <a id="3181" href="/agda_html/Leios.Blocks.html#2304" class="Function">getIBRef</a> <a id="3190" href="/agda_html/Function.Base.html#1974" class="Function Operator">$</a> <a id="3192" href="/agda_html/Leios.Prelude.html#1171" class="Function">filter</a> <a id="3199" class="Symbol">(</a><a id="3200" href="/agda_html/Leios.Blocks.html#527" class="Function Operator">_∈ᴮ</a> <a id="3204" href="/agda_html/Leios.Prelude.html#1001" class="Function">slice</a> <a id="3210" href="/agda_html/Leios.Abstract.html#628" class="Function">L</a> <a id="3212" href="/agda_html/Leios.Protocol.html#1260" class="Function">slot</a> <a id="3217" class="Number">3</a><a id="3218" class="Symbol">)</a> <a id="3220" href="/agda_html/Leios.Protocol.html#1142" class="Function">IBs</a></div>
<div class="line">                <a id="3240" href="/agda_html/Leios.Short.html#3240" class="Bound">h</a> <a id="3242" class="Symbol">=</a> <a id="3244" href="/agda_html/Leios.Blocks.html#3335" class="Function">mkEB</a> <a id="3249" href="/agda_html/Leios.Protocol.html#1260" class="Function">slot</a> <a id="3254" href="/agda_html/Leios.SpecStructure.html#601" class="Field">id</a> <a id="3257" href="/agda_html/Leios.Short.html#1625" class="Generalizable">π</a> <a id="3259" href="/agda_html/Leios.SpecStructure.html#736" class="Field">sk-EB</a> <a id="3265" href="/agda_html/Leios.Short.html#3172" class="Bound">LI</a> <a id="3268" href="/agda_html/Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a></div>
<div class="line">          <a id="3281" class="Keyword">in</a></div>
<div class="line">          <a id="3294" href="/agda_html/Prelude.InferenceRules.html#56074" class="Function Operator">∙</a> <a id="3296" href="/agda_html/Leios.Protocol.html#2023" class="Function">needsUpkeep</a> <a id="3308" href="/agda_html/Leios.Short.html#1096" class="InductiveConstructor">EB-Role</a></div>
<div class="line">          <a id="3326" href="/agda_html/Prelude.InferenceRules.html#56005" class="Function Operator">∙</a> <a id="3328" href="/agda_html/Leios.VRF.html#1418" class="Function">canProduceEB</a> <a id="3341" href="/agda_html/Leios.Protocol.html#1260" class="Function">slot</a> <a id="3346" href="/agda_html/Leios.SpecStructure.html#736" class="Field">sk-EB</a> <a id="3352" class="Symbol">(</a><a id="3353" href="/agda_html/Leios.Protocol.html#2995" class="Function">stake</a> <a id="3359" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a><a id="3360" class="Symbol">)</a> <a id="3362" href="/agda_html/Leios.Short.html#1625" class="Generalizable">π</a></div>
<div class="line">          <a id="3374" href="/agda_html/Prelude.InferenceRules.html#56005" class="Function Operator">∙</a> <a id="3376" href="/agda_html/Leios.Short.html#3150" class="Function">ffds</a> <a id="3381" href="/agda_html/Leios.FFD.html#562" class="Function Operator">FFD.-⟦</a> <a id="3388" href="/agda_html/Leios.FFD.html#311" class="InductiveConstructor">Send</a> <a id="3393" class="Symbol">(</a><a id="3394" href="/agda_html/Leios.Blocks.html#4351" class="InductiveConstructor">ebHeader</a> <a id="3403" href="/agda_html/Leios.Short.html#3240" class="Bound">h</a><a id="3404" class="Symbol">)</a> <a id="3406" href="/agda_html/Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="3414" href="/agda_html/Leios.FFD.html#562" class="Function Operator">/</a> <a id="3416" href="/agda_html/Leios.FFD.html#397" class="InductiveConstructor">SendRes</a> <a id="3424" href="/agda_html/Leios.FFD.html#562" class="Function Operator">⟧⇀</a> <a id="3427" href="/agda_html/Leios.Short.html#1589" class="Generalizable">ffds&#39;</a></div>
<div class="line">          <a id="3443" href="/agda_html/Prelude.InferenceRules.html#11315" class="Function Operator">─────────────────────────────────────────────────────────────────────────</a></div>
<div class="line">          <a id="3527" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a> <a id="3529" href="/agda_html/Leios.Short.html#2523" class="Datatype Operator">↝</a> <a id="3531" href="/agda_html/Leios.Protocol.html#2208" class="Function">addUpkeep</a> <a id="3541" class="Keyword">record</a> <a id="3548" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a> <a id="3550" class="Symbol">{</a> <a id="3552" href="/agda_html/Leios.Protocol.html#1050" class="Field">FFDState</a> <a id="3561" class="Symbol">=</a> <a id="3563" href="/agda_html/Leios.Short.html#1589" class="Generalizable">ffds&#39;</a> <a id="3569" class="Symbol">}</a> <a id="3571" href="/agda_html/Leios.Short.html#1096" class="InductiveConstructor">EB-Role</a></div>
<div class="line"></div></pre>
<pre class="Agda"><div class="line">  <a id="_↝_.VT-Role"></a><a id="3593" href="/agda_html/Leios.Short.html#3593" class="InductiveConstructor">VT-Role</a> <a id="3601" class="Symbol">:</a> <a id="3603" class="Keyword">let</a> <a id="3607" class="Keyword">open</a> <a id="3612" href="/agda_html/Leios.Protocol.html#959" class="Module">LeiosState</a> <a id="3623" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a> <a id="3625" class="Keyword">renaming</a> <a id="3634" class="Symbol">(</a><a id="3635" href="/agda_html/Leios.Protocol.html#1050" class="Field">FFDState</a> <a id="3644" class="Symbol">to</a> <a id="3647" class="Field">ffds</a><a id="3651" class="Symbol">)</a></div>
<div class="line">                <a id="3669" href="/agda_html/Leios.Short.html#3669" class="Bound">EBs&#39;</a> <a id="3674" class="Symbol">=</a> <a id="3676" href="/agda_html/Leios.Prelude.html#1171" class="Function">filter</a> <a id="3683" class="Symbol">(</a><a id="3684" href="/agda_html/Leios.Protocol.html#6510" class="Function">allIBRefsKnown</a> <a id="3699" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a><a id="3700" class="Symbol">)</a> <a id="3702" href="/agda_html/Function.Base.html#1974" class="Function Operator">$</a> <a id="3704" href="/agda_html/Leios.Prelude.html#1171" class="Function">filter</a> <a id="3711" class="Symbol">(</a><a id="3712" href="/agda_html/Leios.Blocks.html#527" class="Function Operator">_∈ᴮ</a> <a id="3716" href="/agda_html/Leios.Prelude.html#1001" class="Function">slice</a> <a id="3722" href="/agda_html/Leios.Abstract.html#628" class="Function">L</a> <a id="3724" href="/agda_html/Leios.Protocol.html#1260" class="Function">slot</a> <a id="3729" class="Number">1</a><a id="3730" class="Symbol">)</a> <a id="3732" href="/agda_html/Leios.Protocol.html#1180" class="Function">EBs</a></div>
<div class="line">                <a id="3752" href="/agda_html/Leios.Short.html#3752" class="Bound">votes</a> <a id="3758" class="Symbol">=</a> <a id="3760" href="/agda_html/abstract-set-theory.Prelude.html#1824" class="Function">map</a> <a id="3764" class="Symbol">(</a><a id="3765" href="/agda_html/Leios.Abstract.html#504" class="Function">vote</a> <a id="3770" href="/agda_html/Leios.SpecStructure.html#742" class="Field">sk-VT</a> <a id="3776" href="/agda_html/Function.Base.html#1115" class="Function Operator">∘</a> <a id="3778" href="/agda_html/Class.Hashable.html#167" class="Field">hash</a><a id="3782" class="Symbol">)</a> <a id="3784" href="/agda_html/Leios.Short.html#3669" class="Bound">EBs&#39;</a></div>
<div class="line">          <a id="3799" class="Keyword">in</a></div>
<div class="line">          <a id="3812" href="/agda_html/Prelude.InferenceRules.html#56074" class="Function Operator">∙</a> <a id="3814" href="/agda_html/Leios.Protocol.html#2023" class="Function">needsUpkeep</a> <a id="3826" href="/agda_html/Leios.Short.html#1104" class="InductiveConstructor">VT-Role</a></div>
<div class="line">          <a id="3844" href="/agda_html/Prelude.InferenceRules.html#56005" class="Function Operator">∙</a> <a id="3846" href="/agda_html/Leios.VRF.html#2022" class="Function">canProduceV</a> <a id="3858" href="/agda_html/Leios.Protocol.html#1260" class="Function">slot</a> <a id="3863" href="/agda_html/Leios.SpecStructure.html#742" class="Field">sk-VT</a> <a id="3869" class="Symbol">(</a><a id="3870" href="/agda_html/Leios.Protocol.html#2995" class="Function">stake</a> <a id="3876" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a><a id="3877" class="Symbol">)</a></div>
<div class="line">          <a id="3889" href="/agda_html/Prelude.InferenceRules.html#56005" class="Function Operator">∙</a> <a id="3891" href="/agda_html/Leios.Short.html#3647" class="Function">ffds</a> <a id="3896" href="/agda_html/Leios.FFD.html#562" class="Function Operator">FFD.-⟦</a> <a id="3903" href="/agda_html/Leios.FFD.html#311" class="InductiveConstructor">Send</a> <a id="3908" class="Symbol">(</a><a id="3909" href="/agda_html/Leios.Blocks.html#4389" class="InductiveConstructor">vtHeader</a> <a id="3918" href="/agda_html/Leios.Short.html#3752" class="Bound">votes</a><a id="3923" class="Symbol">)</a> <a id="3925" href="/agda_html/Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="3933" href="/agda_html/Leios.FFD.html#562" class="Function Operator">/</a> <a id="3935" href="/agda_html/Leios.FFD.html#397" class="InductiveConstructor">SendRes</a> <a id="3943" href="/agda_html/Leios.FFD.html#562" class="Function Operator">⟧⇀</a> <a id="3946" href="/agda_html/Leios.Short.html#1589" class="Generalizable">ffds&#39;</a></div>
<div class="line">          <a id="3962" href="/agda_html/Prelude.InferenceRules.html#11315" class="Function Operator">─────────────────────────────────────────────────────────────────────────</a></div>
<div class="line">          <a id="4046" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a> <a id="4048" href="/agda_html/Leios.Short.html#2523" class="Datatype Operator">↝</a> <a id="4050" href="/agda_html/Leios.Protocol.html#2208" class="Function">addUpkeep</a> <a id="4060" class="Keyword">record</a> <a id="4067" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a> <a id="4069" class="Symbol">{</a> <a id="4071" href="/agda_html/Leios.Protocol.html#1050" class="Field">FFDState</a> <a id="4080" class="Symbol">=</a> <a id="4082" href="/agda_html/Leios.Short.html#1589" class="Generalizable">ffds&#39;</a> <a id="4088" class="Symbol">}</a> <a id="4090" href="/agda_html/Leios.Short.html#1104" class="InductiveConstructor">VT-Role</a></div>
<div class="line"></div></pre>
<h4 id="negative-rules">Negative rules</h4>
<pre class="Agda"><div class="line">  <a id="_↝_.No-IB-Role"></a><a id="4132" href="/agda_html/Leios.Short.html#4132" class="InductiveConstructor">No-IB-Role</a> <a id="4143" class="Symbol">:</a> <a id="4145" class="Keyword">let</a> <a id="4149" class="Keyword">open</a> <a id="4154" href="/agda_html/Leios.Protocol.html#959" class="Module">LeiosState</a> <a id="4165" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a> <a id="4167" class="Keyword">in</a></div>
<div class="line">             <a id="4183" href="/agda_html/Prelude.InferenceRules.html#56074" class="Function Operator">∙</a> <a id="4185" href="/agda_html/Leios.Protocol.html#2023" class="Function">needsUpkeep</a> <a id="4197" href="/agda_html/Leios.Short.html#1088" class="InductiveConstructor">IB-Role</a></div>
<div class="line">             <a id="4218" href="/agda_html/Prelude.InferenceRules.html#56005" class="Function Operator">∙</a> <a id="4220" class="Symbol">(∀</a> <a id="4223" href="/agda_html/Leios.Short.html#4223" class="Bound">π</a> <a id="4225" class="Symbol">→</a> <a id="4227" href="/agda_html/Relation.Nullary.Negation.Core.html#658" class="Function Operator">¬</a> <a id="4229" href="/agda_html/Leios.VRF.html#814" class="Function">canProduceIB</a> <a id="4242" href="/agda_html/Leios.Protocol.html#1260" class="Function">slot</a> <a id="4247" href="/agda_html/Leios.SpecStructure.html#730" class="Field">sk-IB</a> <a id="4253" class="Symbol">(</a><a id="4254" href="/agda_html/Leios.Protocol.html#2995" class="Function">stake</a> <a id="4260" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a><a id="4261" class="Symbol">)</a> <a id="4263" href="/agda_html/Leios.Short.html#4223" class="Bound">π</a><a id="4264" class="Symbol">)</a></div>
<div class="line">             <a id="4279" href="/agda_html/Prelude.InferenceRules.html#13121" class="Function Operator">─────────────────────────────────────────────</a></div>
<div class="line">             <a id="4338" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a> <a id="4340" href="/agda_html/Leios.Short.html#2523" class="Datatype Operator">↝</a> <a id="4342" href="/agda_html/Leios.Protocol.html#2208" class="Function">addUpkeep</a> <a id="4352" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a> <a id="4354" href="/agda_html/Leios.Short.html#1088" class="InductiveConstructor">IB-Role</a></div>
<div class="line"></div></pre>
<pre class="Agda"><div class="line">  <a id="_↝_.No-EB-Role"></a><a id="4376" href="/agda_html/Leios.Short.html#4376" class="InductiveConstructor">No-EB-Role</a> <a id="4387" class="Symbol">:</a> <a id="4389" class="Keyword">let</a> <a id="4393" class="Keyword">open</a> <a id="4398" href="/agda_html/Leios.Protocol.html#959" class="Module">LeiosState</a> <a id="4409" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a> <a id="4411" class="Keyword">in</a></div>
<div class="line">             <a id="4427" href="/agda_html/Prelude.InferenceRules.html#56074" class="Function Operator">∙</a> <a id="4429" href="/agda_html/Leios.Protocol.html#2023" class="Function">needsUpkeep</a> <a id="4441" href="/agda_html/Leios.Short.html#1096" class="InductiveConstructor">EB-Role</a></div>
<div class="line">             <a id="4462" href="/agda_html/Prelude.InferenceRules.html#56005" class="Function Operator">∙</a> <a id="4464" class="Symbol">(∀</a> <a id="4467" href="/agda_html/Leios.Short.html#4467" class="Bound">π</a> <a id="4469" class="Symbol">→</a> <a id="4471" href="/agda_html/Relation.Nullary.Negation.Core.html#658" class="Function Operator">¬</a> <a id="4473" href="/agda_html/Leios.VRF.html#1418" class="Function">canProduceEB</a> <a id="4486" href="/agda_html/Leios.Protocol.html#1260" class="Function">slot</a> <a id="4491" href="/agda_html/Leios.SpecStructure.html#736" class="Field">sk-EB</a> <a id="4497" class="Symbol">(</a><a id="4498" href="/agda_html/Leios.Protocol.html#2995" class="Function">stake</a> <a id="4504" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a><a id="4505" class="Symbol">)</a> <a id="4507" href="/agda_html/Leios.Short.html#4467" class="Bound">π</a><a id="4508" class="Symbol">)</a></div>
<div class="line">             <a id="4523" href="/agda_html/Prelude.InferenceRules.html#13121" class="Function Operator">─────────────────────────────────────────────</a></div>
<div class="line">             <a id="4582" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a> <a id="4584" href="/agda_html/Leios.Short.html#2523" class="Datatype Operator">↝</a> <a id="4586" href="/agda_html/Leios.Protocol.html#2208" class="Function">addUpkeep</a> <a id="4596" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a> <a id="4598" href="/agda_html/Leios.Short.html#1096" class="InductiveConstructor">EB-Role</a></div>
<div class="line"></div></pre>
<pre class="Agda"><div class="line">  <a id="_↝_.No-VT-Role"></a><a id="4620" href="/agda_html/Leios.Short.html#4620" class="InductiveConstructor">No-VT-Role</a> <a id="4631" class="Symbol">:</a> <a id="4633" class="Keyword">let</a> <a id="4637" class="Keyword">open</a> <a id="4642" href="/agda_html/Leios.Protocol.html#959" class="Module">LeiosState</a> <a id="4653" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a> <a id="4655" class="Keyword">in</a></div>
<div class="line">             <a id="4671" href="/agda_html/Prelude.InferenceRules.html#56074" class="Function Operator">∙</a> <a id="4673" href="/agda_html/Leios.Protocol.html#2023" class="Function">needsUpkeep</a> <a id="4685" href="/agda_html/Leios.Short.html#1104" class="InductiveConstructor">VT-Role</a></div>
<div class="line">             <a id="4706" href="/agda_html/Prelude.InferenceRules.html#56005" class="Function Operator">∙</a> <a id="4708" href="/agda_html/Relation.Nullary.Negation.Core.html#658" class="Function Operator">¬</a> <a id="4710" href="/agda_html/Leios.VRF.html#2022" class="Function">canProduceV</a> <a id="4722" href="/agda_html/Leios.Protocol.html#1260" class="Function">slot</a> <a id="4727" href="/agda_html/Leios.SpecStructure.html#742" class="Field">sk-VT</a> <a id="4733" class="Symbol">(</a><a id="4734" href="/agda_html/Leios.Protocol.html#2995" class="Function">stake</a> <a id="4740" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a><a id="4741" class="Symbol">)</a></div>
<div class="line">             <a id="4756" href="/agda_html/Prelude.InferenceRules.html#13121" class="Function Operator">─────────────────────────────────────────────</a></div>
<div class="line">             <a id="4815" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a> <a id="4817" href="/agda_html/Leios.Short.html#2523" class="Datatype Operator">↝</a> <a id="4819" href="/agda_html/Leios.Protocol.html#2208" class="Function">addUpkeep</a> <a id="4829" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a> <a id="4831" href="/agda_html/Leios.Short.html#1104" class="InductiveConstructor">VT-Role</a></div>
<div class="line"></div></pre>
<h3 id="uniform-short-pipeline">Uniform short-pipeline</h3>
<pre class="Agda"><div class="line"><a id="stage"></a><a id="4878" href="/agda_html/Leios.Short.html#4878" class="Function">stage</a> <a id="4884" class="Symbol">:</a> <a id="4886" href="/agda_html/Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="4888" class="Symbol">→</a> <a id="4890" class="Symbol">⦃</a> <a id="4892" href="/agda_html/Leios.Short.html#4892" class="Bound">_</a> <a id="4894" class="Symbol">:</a> <a id="4896" href="/agda_html/Data.Nat.Base.html#3260" class="Record">NonZero</a> <a id="4904" href="/agda_html/Leios.Abstract.html#628" class="Function">L</a> <a id="4906" class="Symbol">⦄</a> <a id="4908" class="Symbol">→</a> <a id="4910" href="/agda_html/Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a></div>
<div class="line"><a id="4912" href="/agda_html/Leios.Short.html#4878" class="Function">stage</a> <a id="4918" href="/agda_html/Leios.Short.html#4918" class="Bound">s</a> <a id="4920" class="Symbol">=</a> <a id="4922" href="/agda_html/Leios.Short.html#4918" class="Bound">s</a> <a id="4924" href="/agda_html/Data.Nat.Base.html#7096" class="Function Operator">/</a> <a id="4926" href="/agda_html/Leios.Abstract.html#628" class="Function">L</a></div>
<div class="line"></div>
<div class="line"><a id="beginningOfStage"></a><a id="4929" href="/agda_html/Leios.Short.html#4929" class="Function">beginningOfStage</a> <a id="4946" class="Symbol">:</a> <a id="4948" href="/agda_html/Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="4950" class="Symbol">→</a> <a id="4952" href="/agda_html/Agda.Primitive.html#388" class="Primitive">Type</a></div>
<div class="line"><a id="4957" href="/agda_html/Leios.Short.html#4929" class="Function">beginningOfStage</a> <a id="4974" href="/agda_html/Leios.Short.html#4974" class="Bound">s</a> <a id="4976" class="Symbol">=</a> <a id="4978" href="/agda_html/Leios.Short.html#4878" class="Function">stage</a> <a id="4984" href="/agda_html/Leios.Short.html#4974" class="Bound">s</a> <a id="4986" href="/agda_html/Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="4988" href="/agda_html/Leios.Abstract.html#628" class="Function">L</a> <a id="4990" href="/agda_html/Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="4992" href="/agda_html/Leios.Short.html#4974" class="Bound">s</a></div>
<div class="line"></div>
<div class="line"><a id="allDone"></a><a id="4995" href="/agda_html/Leios.Short.html#4995" class="Function">allDone</a> <a id="5003" class="Symbol">:</a> <a id="5005" href="/agda_html/Leios.Protocol.html#959" class="Record">LeiosState</a> <a id="5016" class="Symbol">→</a> <a id="5018" href="/agda_html/Agda.Primitive.html#388" class="Primitive">Type</a></div>
<div class="line"><a id="5023" href="/agda_html/Leios.Short.html#4995" class="Function">allDone</a> <a id="5031" href="/agda_html/Leios.Short.html#5031" class="Bound">s</a> <a id="5033" class="Symbol">=</a></div>
<div class="line">  <a id="5037" class="Keyword">let</a> <a id="5041" class="Keyword">open</a> <a id="5046" href="/agda_html/Leios.Protocol.html#959" class="Module">LeiosState</a> <a id="5057" href="/agda_html/Leios.Short.html#5031" class="Bound">s</a></div>
<div class="line">  <a id="5061" class="Keyword">in</a>   <a id="5066" class="Symbol">(</a><a id="5067" href="/agda_html/Leios.Short.html#4929" class="Function">beginningOfStage</a> <a id="5084" href="/agda_html/Leios.Protocol.html#1260" class="Field">slot</a> <a id="5089" href="/agda_html/Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="5091" href="/agda_html/Leios.Protocol.html#1354" class="Field">Upkeep</a> <a id="5098" href="/agda_html/Axiom.Set.html#2587" class="Function Operator">≡ᵉ</a> <a id="5101" href="/agda_html/Axiom.Set.html#5718" class="Function">fromList</a> <a id="5110" class="Symbol">(</a><a id="5111" href="/agda_html/Leios.Short.html#1088" class="InductiveConstructor">IB-Role</a> <a id="5119" href="/agda_html/Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5121" href="/agda_html/Leios.Short.html#1096" class="InductiveConstructor">EB-Role</a> <a id="5129" href="/agda_html/Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5131" href="/agda_html/Leios.Short.html#1104" class="InductiveConstructor">VT-Role</a> <a id="5139" href="/agda_html/Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5141" href="/agda_html/Leios.Short.html#1083" class="InductiveConstructor">Base</a> <a id="5146" href="/agda_html/Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5148" href="/agda_html/Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="5150" class="Symbol">))</a></div>
<div class="line">   <a id="5156" href="/agda_html/Data.Sum.Base.html#625" class="Datatype Operator">⊎</a> <a id="5158" class="Symbol">(</a><a id="5159" href="/agda_html/Relation.Nullary.Negation.Core.html#658" class="Function Operator">¬</a> <a id="5161" href="/agda_html/Leios.Short.html#4929" class="Function">beginningOfStage</a> <a id="5178" href="/agda_html/Leios.Protocol.html#1260" class="Field">slot</a> <a id="5183" href="/agda_html/Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="5185" href="/agda_html/Leios.Protocol.html#1354" class="Field">Upkeep</a> <a id="5192" href="/agda_html/Axiom.Set.html#2587" class="Function Operator">≡ᵉ</a> <a id="5195" href="/agda_html/Axiom.Set.html#5718" class="Function">fromList</a> <a id="5204" class="Symbol">(</a><a id="5205" href="/agda_html/Leios.Short.html#1088" class="InductiveConstructor">IB-Role</a> <a id="5213" href="/agda_html/Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5215" href="/agda_html/Leios.Short.html#1104" class="InductiveConstructor">VT-Role</a> <a id="5223" href="/agda_html/Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5225" href="/agda_html/Leios.Short.html#1083" class="InductiveConstructor">Base</a> <a id="5230" href="/agda_html/Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5232" href="/agda_html/Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="5234" class="Symbol">))</a></div>
<div class="line"></div>
<div class="line"><a id="5238" class="Keyword">data</a> <a id="_-⟦_/_⟧⇀_"></a><a id="5243" href="/agda_html/Leios.Short.html#5243" class="Datatype Operator">_-⟦_/_⟧⇀_</a> <a id="5253" class="Symbol">:</a> <a id="5255" href="/agda_html/Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="5261" href="/agda_html/Leios.Protocol.html#959" class="Record">LeiosState</a> <a id="5272" class="Symbol">→</a> <a id="5274" href="/agda_html/Leios.Protocol.html#708" class="Datatype">LeiosInput</a> <a id="5285" class="Symbol">→</a> <a id="5287" href="/agda_html/Leios.Protocol.html#866" class="Datatype">LeiosOutput</a> <a id="5299" class="Symbol">→</a> <a id="5301" href="/agda_html/Leios.Protocol.html#959" class="Record">LeiosState</a> <a id="5312" class="Symbol">→</a> <a id="5314" href="/agda_html/Agda.Primitive.html#388" class="Primitive">Type</a> <a id="5319" class="Keyword">where</a></div>
<div class="line"></div></pre>
<h4 id="initialization">Initialization</h4>
<pre class="Agda"><div class="line">  <a id="_-⟦_/_⟧⇀_.Init"></a><a id="5359" href="/agda_html/Leios.Short.html#5359" class="InductiveConstructor">Init</a> <a id="5364" class="Symbol">:</a></div>
<div class="line">       <a id="5373" href="/agda_html/Prelude.InferenceRules.html#56074" class="Function Operator">∙</a> <a id="5375" href="/agda_html/Leios.Short.html#1691" class="Generalizable">ks</a> <a id="5378" href="/agda_html/Leios.KeyRegistration.html#476" class="Function Operator">K.-⟦</a> <a id="5383" href="/agda_html/Leios.KeyRegistration.html#302" class="InductiveConstructor">K.INIT</a> <a id="5390" href="/agda_html/Leios.SpecStructure.html#766" class="Field">pk-IB</a> <a id="5396" href="/agda_html/Leios.SpecStructure.html#772" class="Field">pk-EB</a> <a id="5402" href="/agda_html/Leios.SpecStructure.html#778" class="Field">pk-VT</a> <a id="5408" href="/agda_html/Leios.KeyRegistration.html#476" class="Function Operator">/</a> <a id="5410" href="/agda_html/Leios.KeyRegistration.html#374" class="InductiveConstructor">K.PUBKEYS</a> <a id="5420" href="/agda_html/Leios.Short.html#2005" class="Generalizable">pks</a> <a id="5424" href="/agda_html/Leios.KeyRegistration.html#476" class="Function Operator">⟧⇀</a> <a id="5427" href="/agda_html/Leios.Short.html#1694" class="Generalizable">ks&#39;</a></div>
<div class="line">       <a id="5438" href="/agda_html/Prelude.InferenceRules.html#56005" class="Function Operator">∙</a> <a id="5440" href="/agda_html/Leios.SpecStructure.html#904" class="Field">initBaseState</a> <a id="5454" href="/agda_html/Leios.Base.html#870" class="Function Operator">B.-⟦</a> <a id="5459" href="/agda_html/Leios.Base.html#576" class="InductiveConstructor">B.INIT</a> <a id="5466" class="Symbol">(</a><a id="5467" href="/agda_html/Leios.Base.html#490" class="Function">V-chkCerts</a> <a id="5478" href="/agda_html/Leios.Short.html#2005" class="Generalizable">pks</a><a id="5481" class="Symbol">)</a> <a id="5483" href="/agda_html/Leios.Base.html#870" class="Function Operator">/</a> <a id="5485" href="/agda_html/Leios.Base.html#710" class="InductiveConstructor">B.STAKE</a> <a id="5493" href="/agda_html/Leios.Short.html#1968" class="Generalizable">SD</a> <a id="5496" href="/agda_html/Leios.Base.html#870" class="Function Operator">⟧⇀</a> <a id="5499" href="/agda_html/Leios.Short.html#1657" class="Generalizable">bs&#39;</a></div>
<div class="line">       <a id="5510" href="/agda_html/Prelude.InferenceRules.html#11981" class="Function Operator">────────────────────────────────────────────────────────────────</a></div>
<div class="line">       <a id="5582" href="/agda_html/Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="5590" href="/agda_html/Leios.Short.html#5243" class="Datatype Operator">-⟦</a> <a id="5593" href="/agda_html/Leios.Protocol.html#734" class="InductiveConstructor">INIT</a> <a id="5598" href="/agda_html/Leios.Short.html#1938" class="Generalizable">V</a> <a id="5600" href="/agda_html/Leios.Short.html#5243" class="Datatype Operator">/</a> <a id="5602" href="/agda_html/Leios.Protocol.html#928" class="InductiveConstructor">EMPTY</a> <a id="5608" href="/agda_html/Leios.Short.html#5243" class="Datatype Operator">⟧⇀</a> <a id="5611" href="/agda_html/Leios.Protocol.html#2378" class="Function">initLeiosState</a> <a id="5626" href="/agda_html/Leios.Short.html#1938" class="Generalizable">V</a> <a id="5628" href="/agda_html/Leios.Short.html#1968" class="Generalizable">SD</a> <a id="5631" href="/agda_html/Leios.Short.html#1657" class="Generalizable">bs&#39;</a> <a id="5635" href="/agda_html/Leios.Short.html#2005" class="Generalizable">pks</a></div>
<div class="line"></div></pre>
<h4 id="network-and-ledger">Network and Ledger</h4>
<pre class="Agda"><div class="line">  <a id="_-⟦_/_⟧⇀_.Slot"></a><a id="5677" href="/agda_html/Leios.Short.html#5677" class="InductiveConstructor">Slot</a> <a id="5682" class="Symbol">:</a> <a id="5684" class="Keyword">let</a> <a id="5688" class="Keyword">open</a> <a id="5693" href="/agda_html/Leios.Protocol.html#959" class="Module">LeiosState</a> <a id="5704" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a> <a id="5706" class="Keyword">renaming</a> <a id="5715" class="Symbol">(</a><a id="5716" href="/agda_html/Leios.Protocol.html#1050" class="Field">FFDState</a> <a id="5725" class="Symbol">to</a> <a id="5728" class="Field">ffds</a><a id="5732" class="Symbol">;</a> <a id="5734" href="/agda_html/Leios.Protocol.html#1389" class="Field">BaseState</a> <a id="5744" class="Symbol">to</a> <a id="5747" class="Field">bs</a><a id="5749" class="Symbol">)</a> <a id="5751" class="Keyword">in</a></div>
<div class="line">       <a id="5761" href="/agda_html/Prelude.InferenceRules.html#56074" class="Function Operator">∙</a> <a id="5763" href="/agda_html/Leios.Short.html#4995" class="Function">allDone</a> <a id="5771" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a></div>
<div class="line">       <a id="5780" href="/agda_html/Prelude.InferenceRules.html#56005" class="Function Operator">∙</a> <a id="5782" href="/agda_html/Leios.Short.html#5747" class="Function">bs</a> <a id="5785" href="/agda_html/Leios.Base.html#870" class="Function Operator">B.-⟦</a> <a id="5790" href="/agda_html/Leios.Base.html#661" class="InductiveConstructor">B.FTCH-LDG</a> <a id="5801" href="/agda_html/Leios.Base.html#870" class="Function Operator">/</a> <a id="5803" href="/agda_html/Leios.Base.html#761" class="InductiveConstructor">B.BASE-LDG</a> <a id="5814" href="/agda_html/Leios.Short.html#1860" class="Generalizable">rbs</a> <a id="5818" href="/agda_html/Leios.Base.html#870" class="Function Operator">⟧⇀</a> <a id="5821" href="/agda_html/Leios.Short.html#1657" class="Generalizable">bs&#39;</a></div>
<div class="line">       <a id="5832" href="/agda_html/Prelude.InferenceRules.html#56005" class="Function Operator">∙</a> <a id="5834" href="/agda_html/Leios.Short.html#5728" class="Function">ffds</a> <a id="5839" href="/agda_html/Leios.FFD.html#562" class="Function Operator">FFD.-⟦</a> <a id="5846" href="/agda_html/Leios.FFD.html#351" class="InductiveConstructor">Fetch</a> <a id="5852" href="/agda_html/Leios.FFD.html#562" class="Function Operator">/</a> <a id="5854" href="/agda_html/Leios.FFD.html#419" class="InductiveConstructor">FetchRes</a> <a id="5863" href="/agda_html/Leios.Short.html#1725" class="Generalizable">msgs</a> <a id="5868" href="/agda_html/Leios.FFD.html#562" class="Function Operator">⟧⇀</a> <a id="5871" href="/agda_html/Leios.Short.html#1589" class="Generalizable">ffds&#39;</a></div>
<div class="line">       <a id="5884" href="/agda_html/Prelude.InferenceRules.html#11470" class="Function Operator">───────────────────────────────────────────────────────────────────────</a></div>
<div class="line">       <a id="5963" href="/agda_html/Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="5968" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a> <a id="5970" href="/agda_html/Leios.Short.html#5243" class="Datatype Operator">-⟦</a> <a id="5973" href="/agda_html/Leios.Protocol.html#814" class="InductiveConstructor">SLOT</a> <a id="5978" href="/agda_html/Leios.Short.html#5243" class="Datatype Operator">/</a> <a id="5980" href="/agda_html/Leios.Protocol.html#928" class="InductiveConstructor">EMPTY</a> <a id="5986" href="/agda_html/Leios.Short.html#5243" class="Datatype Operator">⟧⇀</a> <a id="5989" class="Keyword">record</a> <a id="5996" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a></div>
<div class="line">           <a id="6009" class="Symbol">{</a> <a id="6011" href="/agda_html/Leios.Protocol.html#1050" class="Field">FFDState</a>  <a id="6021" class="Symbol">=</a> <a id="6023" href="/agda_html/Leios.Short.html#1589" class="Generalizable">ffds&#39;</a></div>
<div class="line">           <a id="6040" class="Symbol">;</a> <a id="6042" href="/agda_html/Leios.Protocol.html#1389" class="Field">BaseState</a> <a id="6052" class="Symbol">=</a> <a id="6054" href="/agda_html/Leios.Short.html#1657" class="Generalizable">bs&#39;</a></div>
<div class="line">           <a id="6069" class="Symbol">;</a> <a id="6071" href="/agda_html/Leios.Protocol.html#1082" class="Field">Ledger</a>    <a id="6081" class="Symbol">=</a> <a id="6083" href="/agda_html/Leios.Protocol.html#1896" class="Function">constructLedger</a> <a id="6099" href="/agda_html/Leios.Short.html#1860" class="Generalizable">rbs</a></div>
<div class="line">           <a id="6114" class="Symbol">;</a> <a id="6116" href="/agda_html/Leios.Protocol.html#1260" class="Field">slot</a>      <a id="6126" class="Symbol">=</a> <a id="6128" href="/agda_html/Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="6132" href="/agda_html/Leios.Protocol.html#1260" class="Function">slot</a></div>
<div class="line">           <a id="6148" class="Symbol">;</a> <a id="6150" href="/agda_html/Leios.Protocol.html#1354" class="Field">Upkeep</a>    <a id="6160" class="Symbol">=</a> <a id="6162" href="/agda_html/Class.HasEmptySet.html#287" class="Field">∅</a></div>
<div class="line">           <a id="6175" class="Symbol">}</a> <a id="6177" href="/agda_html/Leios.Protocol.html#7915" class="Function Operator">↑</a> <a id="6179" href="/agda_html/Data.List.Base.html#10687" class="Function">L.filter</a> <a id="6188" class="Symbol">(</a><a id="6189" href="/agda_html/Leios.Protocol.html#6253" class="Function">isValid?</a> <a id="6198" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a><a id="6199" class="Symbol">)</a> <a id="6201" href="/agda_html/Leios.Short.html#1725" class="Generalizable">msgs</a></div>
<div class="line"></div></pre>
<pre class="Agda"><div class="line">  <a id="_-⟦_/_⟧⇀_.Ftch"></a><a id="6220" href="/agda_html/Leios.Short.html#6220" class="InductiveConstructor">Ftch</a> <a id="6225" class="Symbol">:</a></div>
<div class="line">       <a id="6234" href="/agda_html/Prelude.InferenceRules.html#42426" class="Function Operator">────────────────────────────────────────────────────────</a></div>
<div class="line">       <a id="6298" href="/agda_html/Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="6303" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a> <a id="6305" href="/agda_html/Leios.Short.html#5243" class="Datatype Operator">-⟦</a> <a id="6308" href="/agda_html/Leios.Protocol.html#838" class="InductiveConstructor">FTCH-LDG</a> <a id="6317" href="/agda_html/Leios.Short.html#5243" class="Datatype Operator">/</a> <a id="6319" href="/agda_html/Leios.Protocol.html#893" class="InductiveConstructor">FTCH-LDG</a> <a id="6328" class="Symbol">(</a><a id="6329" href="/agda_html/Leios.Protocol.html#1082" class="Field">LeiosState.Ledger</a> <a id="6347" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a><a id="6348" class="Symbol">)</a> <a id="6350" href="/agda_html/Leios.Short.html#5243" class="Datatype Operator">⟧⇀</a> <a id="6353" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a></div>
<div class="line"></div></pre>
<h4 id="base-chain">Base chain</h4>
Note: Submitted data to the base chain is only taken into account if the
party submitting is the block producer on the base chain for the given
slot
<pre class="Agda"><div class="line">  <a id="_-⟦_/_⟧⇀_.Base₁"></a><a id="6547" href="/agda_html/Leios.Short.html#6547" class="InductiveConstructor">Base₁</a>   <a id="6555" class="Symbol">:</a></div>
<div class="line">          <a id="6567" href="/agda_html/Prelude.InferenceRules.html#41139" class="Function Operator">───────────────────────────────────────────────────────────────────</a></div>
<div class="line">          <a id="6645" href="/agda_html/Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="6650" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a> <a id="6652" href="/agda_html/Leios.Short.html#5243" class="Datatype Operator">-⟦</a> <a id="6655" href="/agda_html/Leios.Protocol.html#764" class="InductiveConstructor">SUBMIT</a> <a id="6662" class="Symbol">(</a><a id="6663" href="/agda_html/Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="6668" href="/agda_html/Leios.Short.html#1904" class="Generalizable">txs</a><a id="6671" class="Symbol">)</a> <a id="6673" href="/agda_html/Leios.Short.html#5243" class="Datatype Operator">/</a> <a id="6675" href="/agda_html/Leios.Protocol.html#928" class="InductiveConstructor">EMPTY</a> <a id="6681" href="/agda_html/Leios.Short.html#5243" class="Datatype Operator">⟧⇀</a> <a id="6684" class="Keyword">record</a> <a id="6691" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a> <a id="6693" class="Symbol">{</a> <a id="6695" href="/agda_html/Leios.Protocol.html#1112" class="Field">ToPropose</a> <a id="6705" class="Symbol">=</a> <a id="6707" href="/agda_html/Leios.Short.html#1904" class="Generalizable">txs</a> <a id="6711" class="Symbol">}</a></div>
<div class="line"></div></pre>
<pre class="Agda"><div class="line">  <a id="_-⟦_/_⟧⇀_.Base₂a"></a><a id="6727" href="/agda_html/Leios.Short.html#6727" class="InductiveConstructor">Base₂a</a>  <a id="6735" class="Symbol">:</a> <a id="6737" class="Keyword">let</a> <a id="6741" class="Keyword">open</a> <a id="6746" href="/agda_html/Leios.Protocol.html#959" class="Module">LeiosState</a> <a id="6757" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a> <a id="6759" class="Keyword">renaming</a> <a id="6768" class="Symbol">(</a><a id="6769" href="/agda_html/Leios.Protocol.html#1389" class="Field">BaseState</a> <a id="6779" class="Symbol">to</a> <a id="6782" class="Field">bs</a><a id="6784" class="Symbol">)</a> <a id="6786" class="Keyword">in</a></div>
<div class="line">          <a id="6799" href="/agda_html/Prelude.InferenceRules.html#56074" class="Function Operator">∙</a> <a id="6801" href="/agda_html/Leios.Protocol.html#2023" class="Function">needsUpkeep</a> <a id="6813" href="/agda_html/Leios.Short.html#1083" class="InductiveConstructor">Base</a></div>
<div class="line">          <a id="6828" href="/agda_html/Prelude.InferenceRules.html#56005" class="Function Operator">∙</a> <a id="6830" href="/agda_html/Leios.Short.html#1820" class="Generalizable">eb</a> <a id="6833" href="/agda_html/Class.IsSet.html#458" class="Function Operator">∈</a> <a id="6835" href="/agda_html/Leios.Prelude.html#1171" class="Function">filter</a> <a id="6842" class="Symbol">(λ</a> <a id="6845" href="/agda_html/Leios.Short.html#6845" class="Bound">eb</a> <a id="6848" class="Symbol">→</a> <a id="6850" href="/agda_html/Leios.Short.html#1394" class="Function">isVoteCertified</a> <a id="6866" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a> <a id="6868" href="/agda_html/Leios.Short.html#6845" class="Bound">eb</a> <a id="6871" href="/agda_html/Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="6873" href="/agda_html/Leios.Short.html#6845" class="Bound">eb</a> <a id="6876" href="/agda_html/Leios.Blocks.html#527" class="Function Operator">∈ᴮ</a> <a id="6879" href="/agda_html/Leios.Prelude.html#1001" class="Function">slice</a> <a id="6885" href="/agda_html/Leios.Abstract.html#628" class="Function">L</a> <a id="6887" href="/agda_html/Leios.Protocol.html#1260" class="Function">slot</a> <a id="6892" class="Number">2</a><a id="6893" class="Symbol">)</a> <a id="6895" href="/agda_html/Leios.Protocol.html#1180" class="Function">EBs</a></div>
<div class="line">          <a id="6909" href="/agda_html/Prelude.InferenceRules.html#56005" class="Function Operator">∙</a> <a id="6911" href="/agda_html/Leios.Short.html#6782" class="Function">bs</a> <a id="6914" href="/agda_html/Leios.Base.html#870" class="Function Operator">B.-⟦</a> <a id="6919" href="/agda_html/Leios.Base.html#627" class="InductiveConstructor">B.SUBMIT</a> <a id="6928" class="Symbol">(</a><a id="6929" href="/agda_html/Data.These.Base.html#595" class="InductiveConstructor">this</a> <a id="6934" href="/agda_html/Leios.Short.html#1820" class="Generalizable">eb</a><a id="6936" class="Symbol">)</a> <a id="6938" href="/agda_html/Leios.Base.html#870" class="Function Operator">/</a> <a id="6940" href="/agda_html/Leios.Base.html#742" class="InductiveConstructor">B.EMPTY</a> <a id="6948" href="/agda_html/Leios.Base.html#870" class="Function Operator">⟧⇀</a> <a id="6951" href="/agda_html/Leios.Short.html#1657" class="Generalizable">bs&#39;</a></div>
<div class="line">          <a id="6965" href="/agda_html/Prelude.InferenceRules.html#11470" class="Function Operator">───────────────────────────────────────────────────────────────────────</a></div>
<div class="line">          <a id="7047" href="/agda_html/Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="7052" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a> <a id="7054" href="/agda_html/Leios.Short.html#5243" class="Datatype Operator">-⟦</a> <a id="7057" href="/agda_html/Leios.Protocol.html#814" class="InductiveConstructor">SLOT</a> <a id="7062" href="/agda_html/Leios.Short.html#5243" class="Datatype Operator">/</a> <a id="7064" href="/agda_html/Leios.Protocol.html#928" class="InductiveConstructor">EMPTY</a> <a id="7070" href="/agda_html/Leios.Short.html#5243" class="Datatype Operator">⟧⇀</a> <a id="7073" href="/agda_html/Leios.Protocol.html#2208" class="Function">addUpkeep</a> <a id="7083" class="Keyword">record</a> <a id="7090" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a> <a id="7092" class="Symbol">{</a> <a id="7094" href="/agda_html/Leios.Protocol.html#1389" class="Field">BaseState</a> <a id="7104" class="Symbol">=</a> <a id="7106" href="/agda_html/Leios.Short.html#1657" class="Generalizable">bs&#39;</a> <a id="7110" class="Symbol">}</a> <a id="7112" href="/agda_html/Leios.Short.html#1083" class="InductiveConstructor">Base</a></div>
<div class="line"></div>
<div class="line">  <a id="_-⟦_/_⟧⇀_.Base₂b"></a><a id="7120" href="/agda_html/Leios.Short.html#7120" class="InductiveConstructor">Base₂b</a>  <a id="7128" class="Symbol">:</a> <a id="7130" class="Keyword">let</a> <a id="7134" class="Keyword">open</a> <a id="7139" href="/agda_html/Leios.Protocol.html#959" class="Module">LeiosState</a> <a id="7150" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a> <a id="7152" class="Keyword">renaming</a> <a id="7161" class="Symbol">(</a><a id="7162" href="/agda_html/Leios.Protocol.html#1389" class="Field">BaseState</a> <a id="7172" class="Symbol">to</a> <a id="7175" class="Field">bs</a><a id="7177" class="Symbol">)</a> <a id="7179" class="Keyword">in</a></div>
<div class="line">          <a id="7192" href="/agda_html/Prelude.InferenceRules.html#56074" class="Function Operator">∙</a> <a id="7194" href="/agda_html/Leios.Protocol.html#2023" class="Function">needsUpkeep</a> <a id="7206" href="/agda_html/Leios.Short.html#1083" class="InductiveConstructor">Base</a></div>
<div class="line">          <a id="7221" href="/agda_html/Prelude.InferenceRules.html#56005" class="Function Operator">∙</a> <a id="7223" href="/agda_html/Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="7226" href="/agda_html/Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="7228" href="/agda_html/Leios.Prelude.html#1171" class="Function">filter</a> <a id="7235" class="Symbol">(λ</a> <a id="7238" href="/agda_html/Leios.Short.html#7238" class="Bound">eb</a> <a id="7241" class="Symbol">→</a> <a id="7243" href="/agda_html/Leios.Short.html#1394" class="Function">isVoteCertified</a> <a id="7259" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a> <a id="7261" href="/agda_html/Leios.Short.html#7238" class="Bound">eb</a> <a id="7264" href="/agda_html/Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="7266" href="/agda_html/Leios.Short.html#7238" class="Bound">eb</a> <a id="7269" href="/agda_html/Leios.Blocks.html#527" class="Function Operator">∈ᴮ</a> <a id="7272" href="/agda_html/Leios.Prelude.html#1001" class="Function">slice</a> <a id="7278" href="/agda_html/Leios.Abstract.html#628" class="Function">L</a> <a id="7280" href="/agda_html/Leios.Protocol.html#1260" class="Function">slot</a> <a id="7285" class="Number">2</a><a id="7286" class="Symbol">)</a> <a id="7288" href="/agda_html/Leios.Protocol.html#1180" class="Function">EBs</a></div>
<div class="line">          <a id="7302" href="/agda_html/Prelude.InferenceRules.html#56005" class="Function Operator">∙</a> <a id="7304" href="/agda_html/Leios.Short.html#7175" class="Function">bs</a> <a id="7307" href="/agda_html/Leios.Base.html#870" class="Function Operator">B.-⟦</a> <a id="7312" href="/agda_html/Leios.Base.html#627" class="InductiveConstructor">B.SUBMIT</a> <a id="7321" class="Symbol">(</a><a id="7322" href="/agda_html/Data.These.Base.html#623" class="InductiveConstructor">that</a> <a id="7327" href="/agda_html/Leios.Protocol.html#1112" class="Function">ToPropose</a><a id="7336" class="Symbol">)</a> <a id="7338" href="/agda_html/Leios.Base.html#870" class="Function Operator">/</a> <a id="7340" href="/agda_html/Leios.Base.html#742" class="InductiveConstructor">B.EMPTY</a> <a id="7348" href="/agda_html/Leios.Base.html#870" class="Function Operator">⟧⇀</a> <a id="7351" href="/agda_html/Leios.Short.html#1657" class="Generalizable">bs&#39;</a></div>
<div class="line">          <a id="7365" href="/agda_html/Prelude.InferenceRules.html#11470" class="Function Operator">───────────────────────────────────────────────────────────────────────</a></div>
<div class="line">          <a id="7447" href="/agda_html/Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="7452" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a> <a id="7454" href="/agda_html/Leios.Short.html#5243" class="Datatype Operator">-⟦</a> <a id="7457" href="/agda_html/Leios.Protocol.html#814" class="InductiveConstructor">SLOT</a> <a id="7462" href="/agda_html/Leios.Short.html#5243" class="Datatype Operator">/</a> <a id="7464" href="/agda_html/Leios.Protocol.html#928" class="InductiveConstructor">EMPTY</a> <a id="7470" href="/agda_html/Leios.Short.html#5243" class="Datatype Operator">⟧⇀</a> <a id="7473" href="/agda_html/Leios.Protocol.html#2208" class="Function">addUpkeep</a> <a id="7483" class="Keyword">record</a> <a id="7490" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a> <a id="7492" class="Symbol">{</a> <a id="7494" href="/agda_html/Leios.Protocol.html#1389" class="Field">BaseState</a> <a id="7504" class="Symbol">=</a> <a id="7506" href="/agda_html/Leios.Short.html#1657" class="Generalizable">bs&#39;</a> <a id="7510" class="Symbol">}</a> <a id="7512" href="/agda_html/Leios.Short.html#1083" class="InductiveConstructor">Base</a></div>
<div class="line"></div></pre>
<h4 id="protocol-rules">Protocol rules</h4>
<pre class="Agda"><div class="line">  <a id="_-⟦_/_⟧⇀_.Roles"></a><a id="7551" href="/agda_html/Leios.Short.html#7551" class="InductiveConstructor">Roles</a> <a id="7557" class="Symbol">:</a></div>
<div class="line">        <a id="7567" href="/agda_html/Prelude.InferenceRules.html#56074" class="Function Operator">∙</a> <a id="7569" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a> <a id="7571" href="/agda_html/Leios.Short.html#2523" class="Datatype Operator">↝</a> <a id="7573" href="/agda_html/Leios.Short.html#1554" class="Generalizable">s&#39;</a></div>
<div class="line">        <a id="7584" href="/agda_html/Prelude.InferenceRules.html#13801" class="Function Operator">─────────────────────────────</a></div>
<div class="line">        <a id="7622" href="/agda_html/Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="7627" href="/agda_html/Leios.Short.html#1552" class="Generalizable">s</a> <a id="7629" href="/agda_html/Leios.Short.html#5243" class="Datatype Operator">-⟦</a> <a id="7632" href="/agda_html/Leios.Protocol.html#814" class="InductiveConstructor">SLOT</a> <a id="7637" href="/agda_html/Leios.Short.html#5243" class="Datatype Operator">/</a> <a id="7639" href="/agda_html/Leios.Protocol.html#928" class="InductiveConstructor">EMPTY</a> <a id="7645" href="/agda_html/Leios.Short.html#5243" class="Datatype Operator">⟧⇀</a> <a id="7648" href="/agda_html/Leios.Short.html#1554" class="Generalizable">s&#39;</a></div>
<div class="line"></div></pre>
</main></div></body>
</html>
