<?xml version="1.0" encoding="UTF-8"?>
<svg width="1200" height="700" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <!-- Pattern for inactive periods -->
    <pattern id="inactivePattern" x="0" y="0" width="20" height="20" patternUnits="userSpaceOnUse">
      <rect width="20" height="20" fill="#fef8f3"/>
      <line x1="0" y1="20" x2="20" y2="0" stroke="#f6d3b4" stroke-width="0.3"/>
    </pattern>
    
    <!-- Pattern for active periods -->
    <pattern id="activePattern" x="0" y="0" width="20" height="20" patternUnits="userSpaceOnUse">
      <rect width="20" height="20" fill="#f0f8e8"/>
      <line x1="0" y1="20" x2="20" y2="0" stroke="#d4edda" stroke-width="0.3"/>
    </pattern>
    
    <!-- Smaller arrow marker -->
    <marker id="arrowhead" markerWidth="6" markerHeight="4" refX="5" refY="2" orient="auto">
      <polygon points="0 0, 6 2, 0 4" fill="#595959"/>
    </marker>
    
    <!-- Arrow marker for votes/certificates -->
    <marker id="votearrowhead" markerWidth="6" markerHeight="4" refX="5" refY="2" orient="auto">
      <polygon points="0 0, 6 2, 0 4" fill="#f9a825"/>
    </marker>
    
    <!-- Gradient for de-emphasizing uncertified EBs -->
    <linearGradient id="fadeGradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:white;stop-opacity:0.5"/>
      <stop offset="100%" style="stop-color:white;stop-opacity:0.3"/>
    </linearGradient>
    
    <!-- Mask for de-emphasizing uncertified EBs -->
    <mask id="deemphasizeMask">
      <rect width="100%" height="100%" fill="url(#fadeGradient)"/>
    </mask>
    
    <!-- Hover effects -->
    <style>
      .block-link, .vote-link, .param-link {
        cursor: pointer;
      }
      .block-link:hover rect {
        stroke-width: 3;
        filter: brightness(1.1);
      }
      .block-link:hover polygon {
        stroke-width: 3;
        filter: brightness(1.1);
      }
      .block-link:hover text {
        font-weight: bold;
      }
      .vote-link:hover rect {
        transform: scale(2.0);
        filter: brightness(1.5) saturate(1.3);
        stroke: #ff6b35;
        stroke-width: 1;
      }
      .param-link:hover line,
      .param-link:hover path {
        stroke-width: 3;
        filter: brightness(1.1);
      }
      .param-link:hover text {
        font-weight: bold;
      }
    </style>
  </defs>
  
  <!-- Background -->
  <rect width="1200" height="700" fill="#ffffff"/>
  
  <!-- Protocol state timeline (background) -->
  <g id="state-timeline">
    <!-- Inactive period -->
    <rect x="50" y="40" width="310" height="40" fill="url(#inactivePattern)" stroke="#783f04" stroke-width="0.5" stroke-opacity="0.3"/>
    <text x="205" y="60" dominant-baseline="middle" font-family="Arial, sans-serif" font-size="14" text-anchor="middle" fill="#783f04">Standard Validation</text>
    
    <!-- Active period (aligned with L_recover start and end) -->
    <rect x="360" y="40" width="520" height="40" fill="url(#activePattern)" stroke="#7cb342" stroke-width="0.5" stroke-opacity="0.3"/>
    <text x="620" y="60" dominant-baseline="middle" font-family="Arial, sans-serif" font-size="14" text-anchor="middle" fill="#5a8030">Certificate-Active</text>
    
    <!-- Inactive period after windows expire -->
    <rect x="880" y="40" width="270" height="40" fill="url(#inactivePattern)" stroke="#783f04" stroke-width="0.5" stroke-opacity="0.3"/>
    <text x="1015" y="60" dominant-baseline="middle" font-family="Arial, sans-serif" font-size="14" text-anchor="middle" fill="#783f04">Standard Validation</text>
  </g>
  
  <!-- L_recover window indicators (thin lines with offsets for overlaps) -->
  <g id="window-indicators">
    <!-- First L_recover window from RB3 (center at x=360, same width as second window) -->
    <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#l-recover" class="param-link">
      <line x1="360" y1="20" x2="360" y2="136" stroke="#7cb342" stroke-width="1.5" stroke-dasharray="3,3" opacity="0.8"/>
      <line x1="360" y1="25" x2="660" y2="25" stroke="#7cb342" stroke-width="4" opacity="0.9"/>
      <line x1="660" y1="20" x2="660" y2="40" stroke="#7cb342" stroke-width="1.5" stroke-dasharray="3,3" opacity="0.8"/>
      <text x="510" y="15" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#5a8030"><tspan font-family="Times New Roman, serif" font-style="italic" font-size="14">L</tspan><tspan font-size="9" baseline-shift="sub">recover-RB3</tspan></text>
    </a>
    
    <!-- Second L_recover window from RB5 (center at x=580, overlapping first) -->
    <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#l-recover" class="param-link">
      <line x1="580" y1="20" x2="580" y2="136" stroke="#7cb342" stroke-width="1.5" stroke-dasharray="3,3" opacity="0.8"/>
      <line x1="580" y1="33" x2="880" y2="33" stroke="#7cb342" stroke-width="4" opacity="0.9"/>
      <line x1="880" y1="20" x2="880" y2="136" stroke="#7cb342" stroke-width="1.5" stroke-dasharray="3,3" opacity="0.8"/>
      <text x="730" y="47" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#5a8030"><tspan font-family="Times New Roman, serif" font-style="italic" font-size="14">L</tspan><tspan font-size="9" baseline-shift="sub">recover-RB5</tspan></text>
    </a>
  </g>
  
  <!-- Annotations for window transitions -->
  <g id="annotations">
    <!-- Certificate triggers window -->
    <text x="365" y="105" font-family="Arial, sans-serif" font-size="12" fill="#595959">Certificate starts</text>
    <text x="365" y="122" font-family="Arial, sans-serif" font-size="12" fill="#595959"><tspan font-family="Times New Roman, serif" font-style="italic" font-size="14">L</tspan><tspan font-size="10" baseline-shift="sub">recover</tspan> window</text>
    
    <!-- Second certificate resets window -->
    <text x="585" y="105" font-family="Arial, sans-serif" font-size="12" fill="#595959">Overlaps with <tspan font-family="Times New Roman, serif" font-style="italic" font-size="14">L</tspan><tspan font-size="10" baseline-shift="sub">recover-RB3</tspan></text>
    <text x="585" y="122" font-family="Arial, sans-serif" font-size="12" fill="#595959">Extends high throughput period</text>
    
    <!-- Windows expiration -->
    <text x="885" y="105" font-family="Arial, sans-serif" font-size="12" fill="#595959">Windows expired,</text>
    <text x="885" y="122" font-family="Arial, sans-serif" font-size="12" fill="#595959">validation required</text>
  </g>
  
  <!-- RB/EB Chain -->
  <g id="block-chain">
    <!-- RB1 announces EB1 -->
    <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#ranking-blocks-rbs" class="block-link">
      <rect x="80" y="150" width="80" height="100" fill="#fce5cd" stroke="#783f04" stroke-width="2" rx="8"/>
      <text x="120" y="185" font-family="Arial, sans-serif" font-size="20" font-weight="bold" text-anchor="middle" fill="#783f04">RB₁</text>
      <text x="120" y="208" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#783f04">[Txs]</text>
    </a>
    
    <!-- Arrow from RB1 to EB1 (de-emphasized) -->
    <g mask="url(#deemphasizeMask)">
      <path d="M 120 250 L 120 456" stroke="#783f04" stroke-width="2" stroke-dasharray="4,3" marker-end="url(#arrowhead)"/>
      <text x="125" y="435" font-family="Arial, sans-serif" font-size="12" text-anchor="start" fill="#783f04">announces</text>
      
      <!-- EB1 (not certified) -->
      <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#endorser-blocks-ebs" class="block-link">
        <rect x="60" y="460" width="120" height="80" fill="#d9ead3" stroke="#274e13" stroke-width="2" rx="8"/>
        <text x="120" y="495" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#274e13">EB₁</text>
        <text x="120" y="518" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#274e13">[TxRefs]</text>
      </a>
    </g>
    
    <!-- RB2 with EB announcement -->
    <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#ranking-blocks-rbs" class="block-link">
      <rect x="200" y="150" width="80" height="100" fill="#fce5cd" stroke="#783f04" stroke-width="2" rx="8"/>
      <text x="240" y="185" font-family="Arial, sans-serif" font-size="20" font-weight="bold" text-anchor="middle" fill="#783f04">RB₂</text>
      <text x="240" y="208" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#783f04">[Txs]</text>
    </a>
    
    <!-- Arrow from RB2 to EB2 -->
    <path d="M 240 250 L 240 296" stroke="#783f04" stroke-width="2" stroke-dasharray="4,3" marker-end="url(#arrowhead)"/>
    <text x="245" y="275" font-family="Arial, sans-serif" font-size="12" text-anchor="start" fill="#783f04">announces</text>
    
    <!-- EB2 -->
    <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#endorser-blocks-ebs" class="block-link">
      <rect x="180" y="300" width="120" height="80" fill="#d9ead3" stroke="#274e13" stroke-width="2" rx="8"/>
      <text x="240" y="335" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#274e13">EB₂</text>
      <text x="240" y="358" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#274e13">[TxRefs]</text>
    </a>
    
    <!-- RB3 with certificate (starts first window) - center at x=360 -->
    <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#ranking-blocks-rbs" class="block-link">
      <rect x="320" y="150" width="80" height="100" fill="#fce5cd" stroke="#ff6b6b" stroke-width="2" stroke-dasharray="6,3" rx="8"/>
      <text x="360" y="185" font-family="Arial, sans-serif" font-size="20" font-weight="bold" text-anchor="middle" fill="#783f04">RB₃</text>
      <text x="360" y="208" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#783f04">[Txs]</text>
    </a>
    
    <!-- Arrow from RB3 to EB3 (behind certificate, de-emphasized) -->
    <g mask="url(#deemphasizeMask)">
      <path d="M 360 250 L 360 456" stroke="#783f04" stroke-width="2" stroke-dasharray="4,3" marker-end="url(#arrowhead)"/>
      <text x="365" y="435" font-family="Arial, sans-serif" font-size="12" text-anchor="start" fill="#783f04">announces</text>
      
      <!-- EB3 (not certified) -->
      <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#endorser-blocks-ebs" class="block-link">
        <rect x="300" y="460" width="120" height="80" fill="#d9ead3" stroke="#274e13" stroke-width="2" rx="8"/>
        <text x="360" y="495" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#274e13">EB₃</text>
        <text x="360" y="518" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#274e13">[TxRefs]</text>
      </a>
    </g>
    
    <!-- Certificate symbol -->
    <g transform="translate(360, 250)">
      <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#votes-and-certificates" class="block-link">
        <polygon points="0,-25 25,-12.5 25,12.5 0,25 -25,12.5 -25,-12.5" fill="#fff2cc" stroke="#f9a825" stroke-width="2"/>
        <text x="0" y="5" font-size="12" font-weight="bold" text-anchor="middle" fill="#7f6000"><tspan font-family="serif" font-style="italic" font-size="16">C</tspan><tspan font-family="Arial, sans-serif" font-size="10" font-style="normal" baseline-shift="sub">EB2</tspan></text>
      </a>
    </g>
    
    <!-- Arrow from certificate back to EB2 -->
    <path d="M 360 275 Q 360 340 300 340" stroke="#f9a825" stroke-width="2" stroke-dasharray="2,2" fill="none" marker-end="url(#votearrowhead)"/>
    
    <!-- RB4 announces EB4 (within window) -->
    <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#ranking-blocks-rbs" class="block-link">
      <rect x="440" y="150" width="80" height="100" fill="#fce5cd" stroke="#ff6b6b" stroke-width="2" stroke-dasharray="6,3" rx="8"/>
      <text x="480" y="185" font-family="Arial, sans-serif" font-size="20" font-weight="bold" text-anchor="middle" fill="#783f04">RB₄</text>
      <text x="480" y="208" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#783f04">[Txs]</text>
    </a>
    
    <!-- Chain connections -->
    <path d="M 200 200 L 160 200" stroke="#783f04" stroke-width="2" marker-end="url(#arrowhead)"/>
    <path d="M 320 200 L 280 200" stroke="#783f04" stroke-width="2" marker-end="url(#arrowhead)"/>
    <path d="M 440 200 L 400 200" stroke="#783f04" stroke-width="2" marker-end="url(#arrowhead)"/>
    
    <!-- Arrow from RB4 to EB4 -->
    <path d="M 480 250 L 480 295" stroke="#783f04" stroke-width="2" stroke-dasharray="4,3" marker-end="url(#arrowhead)"/>
    <text x="485" y="275" font-family="Arial, sans-serif" font-size="12" text-anchor="start" fill="#783f04">announces</text>
    
    <!-- EB4 with corrections -->
    <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#endorser-blocks-ebs" class="block-link">
      <rect x="420" y="300" width="120" height="80" fill="#d9ead3" stroke="#274e13" stroke-width="2" rx="8"/>
      <text x="480" y="330" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#274e13">EB₄</text>
      <text x="480" y="370" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#274e13">[TxRefs]</text>
    </a>
    
    <!-- Transaction execution bitmap for EB4 -->
    <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#eb-corrections" class="block-link">
      <rect x="435" y="338" width="90" height="18" fill="#ffcccc" stroke="#cc0000" stroke-width="1" rx="4"/>
      <text x="480" y="347" dominant-baseline="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="#cc0000">&lt;TxBitMap&gt;<tspan font-size="8" baseline-shift="sub">RB3</tspan></text>
    </a>
    
    <!-- RB5 with certificate (resets window) - center at x=580 -->
    <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#ranking-blocks-rbs" class="block-link">
      <rect x="540" y="150" width="80" height="100" fill="#fce5cd" stroke="#ff6b6b" stroke-width="2" stroke-dasharray="6,3" rx="8"/>
      <text x="580" y="185" font-family="Arial, sans-serif" font-size="20" font-weight="bold" text-anchor="middle" fill="#783f04">RB₅</text>
      <text x="580" y="208" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#783f04">[Txs]</text>
    </a>
    
    <!-- Certificate symbol -->
    <g transform="translate(580, 250)">
      <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#votes-and-certificates" class="block-link">
        <polygon points="0,-25 25,-12.5 25,12.5 0,25 -25,12.5 -25,-12.5" fill="#fff2cc" stroke="#f9a825" stroke-width="2"/>
        <text x="0" y="5" font-size="12" font-weight="bold" text-anchor="middle" fill="#7f6000"><tspan font-family="serif" font-style="italic" font-size="16">C</tspan><tspan font-family="Arial, sans-serif" font-size="10" font-style="normal" baseline-shift="sub">EB4</tspan></text>
      </a>
    </g>
    
    <!-- Arrow from certificate to EB4 -->
    <path d="M 580 275 Q 580 340 540 340" stroke="#f9a825" stroke-width="2" stroke-dasharray="2,2" fill="none" marker-end="url(#votearrowhead)"/>
    
    <path d="M 540 200 L 500 200" stroke="#783f04" stroke-width="2" marker-end="url(#arrowhead)"/>
    <path d="M 660 200 L 620 200" stroke="#783f04" stroke-width="2" marker-end="url(#arrowhead)"/>
    
    <!-- More RBs within window -->
    <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#ranking-blocks-rbs" class="block-link">
      <rect x="660" y="150" width="80" height="100" fill="#fce5cd" stroke="#ff6b6b" stroke-width="2" stroke-dasharray="6,3" rx="8"/>
      <text x="700" y="185" font-family="Arial, sans-serif" font-size="20" font-weight="bold" text-anchor="middle" fill="#783f04">RB₆</text>
      <text x="700" y="208" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#783f04">[Txs]</text>
    </a>
    
    <path d="M 780 200 L 740 200" stroke="#783f04" stroke-width="2" marker-end="url(#arrowhead)"/>
    
    <!-- RB7 - last RB in certificate-active period, center at x=820 -->
    <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#ranking-blocks-rbs" class="block-link">
      <rect x="780" y="150" width="80" height="100" fill="#fce5cd" stroke="#ff6b6b" stroke-width="2" stroke-dasharray="6,3" rx="8"/>
      <text x="820" y="185" font-family="Arial, sans-serif" font-size="20" font-weight="bold" text-anchor="middle" fill="#783f04">RB₇</text>
      <text x="820" y="208" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#783f04">[Txs]</text>
    </a>
    
    <path d="M 900 200 L 860 200" stroke="#783f04" stroke-width="2" marker-end="url(#arrowhead)"/>
    
    <!-- First RB after window expires with corrections -->
    <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#ranking-blocks-rbs" class="block-link">
      <rect x="900" y="150" width="80" height="100" fill="#fce5cd" stroke="#783f04" stroke-width="2" rx="8"/>
      <text x="940" y="185" font-family="Arial, sans-serif" font-size="20" font-weight="bold" text-anchor="middle" fill="#783f04">RB₈</text>
      <text x="940" y="208" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#783f04">[Txs]</text>
    </a>
    
    <!-- Transaction execution bitmap for RB8 -->
    <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#rb-corrections" class="block-link">
      <rect x="895" y="215" width="90" height="18" fill="#ffcccc" stroke="#cc0000" stroke-width="1" rx="4"/>
      <text x="940" y="224" dominant-baseline="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="#cc0000">&lt;TxBitMap&gt;<tspan font-size="8" baseline-shift="sub">RB5-7</tspan></text>
    </a>
    
    <path d="M 1020 200 L 980 200" stroke="#783f04" stroke-width="2" stroke-dasharray="4,3" marker-end="url(#arrowhead)"/>
    
    <!-- Continuation dots -->
    <text x="1040" y="201" font-family="Arial, sans-serif" font-size="28" fill="#666" text-anchor="middle">...</text>
  </g>
  
  <!-- Voting timeline with L_vote periods -->
  <g id="voting-timeline">
    <!-- L_vote period for EB1 (de-emphasized) -->
    <g transform="translate(120, 160)" mask="url(#deemphasizeMask)">
      <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#l-vote" class="param-link">
        <line x1="0" y1="415" x2="100" y2="415" stroke="#f9a825" stroke-width="1" stroke-dasharray="4,4"/>
        <path d="M 0 415 L 0 420 Q 0 425 5 425 L 45 425 L 50 432 L 55 425 L 95 425 Q 100 425 100 420 L 100 415" 
              stroke="#f9a825" stroke-width="2" fill="none"/>
        <text x="50" y="445" font-size="16" text-anchor="middle" fill="#f9a825"><tspan font-family="serif" font-style="italic" font-size="20">L</tspan><tspan font-family="Arial, sans-serif" font-size="12" baseline-shift="sub">vote</tspan></text>
      </a>
    </g>
    
    <!-- Vote indicators for EB1 (de-emphasized, fewer votes) -->
    <g id="votes-eb1" transform="translate(120, 160)" mask="url(#deemphasizeMask)">
      <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#votes-and-certificates" class="vote-link">
        <rect x="10" y="395" width="4" height="4" fill="#f9a825" transform="rotate(45 12 397)"/>
      </a>
      <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#votes-and-certificates" class="vote-link">
        <rect x="50" y="395" width="4" height="4" fill="#f9a825" transform="rotate(45 52 397)"/>
      </a>
    </g>
    
    <!-- L_vote period for EB2 -->
    <g transform="translate(240, 0)">
      <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#l-vote" class="param-link">
        <line x1="0" y1="415" x2="100" y2="415" stroke="#f9a825" stroke-width="1" stroke-dasharray="4,4"/>
        <path d="M 0 415 L 0 420 Q 0 425 5 425 L 45 425 L 50 432 L 55 425 L 95 425 Q 100 425 100 420 L 100 415" 
              stroke="#f9a825" stroke-width="2" fill="none"/>
        <text x="50" y="445" font-size="16" text-anchor="middle" fill="#f9a825"><tspan font-family="serif" font-style="italic" font-size="20">L</tspan><tspan font-family="Arial, sans-serif" font-size="12" baseline-shift="sub">vote</tspan></text>
      </a>
    </g>
    
    <!-- Vote indicators for EB1 -->
    <g id="votes1" transform="translate(240, 0)">
      <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#votes-and-certificates" class="vote-link">
        <rect x="10" y="395" width="4" height="4" fill="#f9a825" transform="rotate(45 12 397)"/>
      </a>
      <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#votes-and-certificates" class="vote-link">
        <rect x="30" y="395" width="4" height="4" fill="#f9a825" transform="rotate(45 32 397)"/>
      </a>
      <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#votes-and-certificates" class="vote-link">
        <rect x="50" y="395" width="4" height="4" fill="#f9a825" transform="rotate(45 52 397)"/>
      </a>
      <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#votes-and-certificates" class="vote-link">
        <rect x="70" y="395" width="4" height="4" fill="#f9a825" transform="rotate(45 72 397)"/>
      </a>
      <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#votes-and-certificates" class="vote-link">
        <rect x="90" y="395" width="4" height="4" fill="#f9a825" transform="rotate(45 92 397)"/>
      </a>
    </g>
    
    <!-- L_vote period for EB4 -->
    <g transform="translate(480, 0)">
      <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#l-vote" class="param-link">
        <line x1="0" y1="415" x2="100" y2="415" stroke="#f9a825" stroke-width="1" stroke-dasharray="4,4"/>
        <path d="M 0 415 L 0 420 Q 0 425 5 425 L 45 425 L 50 432 L 55 425 L 95 425 Q 100 425 100 420 L 100 415" 
              stroke="#f9a825" stroke-width="2" fill="none"/>
        <text x="50" y="445" font-size="16" text-anchor="middle" fill="#f9a825"><tspan font-family="serif" font-style="italic" font-size="20">L</tspan><tspan font-family="Arial, sans-serif" font-size="12" baseline-shift="sub">vote</tspan></text>
      </a>
    </g>
    
    <!-- Vote indicators for EB4 -->
    <g id="votes2" transform="translate(480, 0)">
      <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#votes-and-certificates" class="vote-link">
        <rect x="10" y="395" width="4" height="4" fill="#f9a825" transform="rotate(45 12 397)"/>
      </a>
      <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#votes-and-certificates" class="vote-link">
        <rect x="30" y="395" width="4" height="4" fill="#f9a825" transform="rotate(45 32 397)"/>
      </a>
      <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#votes-and-certificates" class="vote-link">
        <rect x="50" y="395" width="4" height="4" fill="#f9a825" transform="rotate(45 52 397)"/>
      </a>
      <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#votes-and-certificates" class="vote-link">
        <rect x="70" y="395" width="4" height="4" fill="#f9a825" transform="rotate(45 72 397)"/>
      </a>
      <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#votes-and-certificates" class="vote-link">
        <rect x="90" y="395" width="4" height="4" fill="#f9a825" transform="rotate(45 92 397)"/>
      </a>
    </g>
    
    <!-- L_vote period for EB3 (de-emphasized) -->
    <g transform="translate(360, 160)" mask="url(#deemphasizeMask)">
      <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#l-vote" class="param-link">
        <line x1="0" y1="415" x2="100" y2="415" stroke="#f9a825" stroke-width="1" stroke-dasharray="4,4"/>
        <path d="M 0 415 L 0 420 Q 0 425 5 425 L 45 425 L 50 432 L 55 425 L 95 425 Q 100 425 100 420 L 100 415" 
              stroke="#f9a825" stroke-width="2" fill="none"/>
        <text x="50" y="445" font-size="16" text-anchor="middle" fill="#f9a825"><tspan font-family="serif" font-style="italic" font-size="20">L</tspan><tspan font-family="Arial, sans-serif" font-size="12" baseline-shift="sub">vote</tspan></text>
      </a>
    </g>
    
    <!-- Vote indicators for EB3 (de-emphasized, fewer votes) -->
    <g id="votes-eb3" transform="translate(360, 160)" mask="url(#deemphasizeMask)">
      <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#votes-and-certificates" class="vote-link">
        <rect x="10" y="395" width="4" height="4" fill="#f9a825" transform="rotate(45 12 397)"/>
      </a>
      <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#votes-and-certificates" class="vote-link">
        <rect x="50" y="395" width="4" height="4" fill="#f9a825" transform="rotate(45 52 397)"/>
      </a>
      <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#votes-and-certificates" class="vote-link">
        <rect x="90" y="395" width="4" height="4" fill="#f9a825" transform="rotate(45 92 397)"/>
      </a>
    </g>
  </g>
  
  <!-- Legend (centered horizontally, two rows) -->
  <g id="legend" transform="translate(150, 620)">
    <text x="450" y="-15" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#333" text-anchor="middle">Legend</text>
    
    <!-- First row: RB, EB, Certificate -->
    <!-- RB solid and dashed side by side -->
    <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#ranking-blocks-rbs" class="block-link">
      <rect x="70" y="0" width="18" height="24" fill="#fce5cd" stroke="#783f04" stroke-width="1.5" rx="2"/>
    </a>
    <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#ranking-blocks-rbs" class="block-link">
      <rect x="92" y="0" width="18" height="24" fill="#fce5cd" stroke="#ff6b6b" stroke-width="1.5" stroke-dasharray="4,2" rx="2"/>
    </a>
    <text x="122" y="16" font-family="Arial, sans-serif" font-size="14" fill="#333">Ranking Block (RB)</text>
    
    <!-- EB -->
    <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#endorser-blocks-ebs" class="block-link">
      <rect x="330" y="3" width="24" height="18" fill="#d9ead3" stroke="#274e13" stroke-width="1.5" rx="2"/>
    </a>
    <text x="360" y="16" font-family="Arial, sans-serif" font-size="14" fill="#333">Endorser Block (EB)</text>
    
    <!-- Certificate -->
    <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#votes-and-certificates" class="block-link">
      <polygon points="570,0 580,6 580,18 570,24 560,18 560,6" fill="#fff2cc" stroke="#f9a825" stroke-width="1"/>
    </a>
    <text x="588" y="16" font-family="Arial, sans-serif" font-size="14" fill="#333">Certificate</text>
    
    <!-- Second row: Vote, L_recover window, Transaction execution bitmap -->
    <!-- Vote -->
    <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#votes-and-certificates" class="vote-link">
      <rect x="125" y="35" width="10" height="10" fill="#f9a825" transform="rotate(45 130 40)"/>
    </a>
    <text x="145" y="46" font-family="Arial, sans-serif" font-size="14" fill="#333">Vote</text>
    
    <!-- L_recover window with dashed verticals -->
    <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#l-recover" class="param-link">
      <line x1="280" y1="37" x2="280" y2="49" stroke="#7cb342" stroke-width="1" stroke-dasharray="2,2" opacity="0.8"/>
      <line x1="280" y1="42" x2="310" y2="42" stroke="#7cb342" stroke-width="3" opacity="0.8"/>
      <line x1="310" y1="37" x2="310" y2="49" stroke="#7cb342" stroke-width="1" stroke-dasharray="2,2" opacity="0.8"/>
      <text x="315" y="46" font-family="Arial, sans-serif" font-size="14" fill="#333"><tspan font-family="Times New Roman, serif" font-style="italic" font-size="16">L</tspan><tspan font-size="10" baseline-shift="sub">recover</tspan> window</text>
    </a>
    
    <!-- Transaction execution bitmap -->
    <rect x="500" y="36" width="30" height="12" fill="#ffcccc" stroke="#cc0000" stroke-width="1" rx="3"/>
    <text x="535" y="46" font-family="Arial, sans-serif" font-size="14" fill="#333">Transaction execution bitmap</text>
  </g>
</svg>