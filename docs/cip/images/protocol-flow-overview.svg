<?xml version="1.0" encoding="UTF-8"?>
<svg width="1200" height="500" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <!-- Define patterns for modes (matching other SVGs) -->
    <pattern id="praosPattern" x="0" y="0" width="20" height="20" patternUnits="userSpaceOnUse">
      <rect width="20" height="20" fill="#fce5cd"/>
      <line x1="0" y1="20" x2="20" y2="0" stroke="#f6d3b4" stroke-width="0.5"/>
    </pattern>
    
    <pattern id="leiosPattern" x="0" y="0" width="20" height="20" patternUnits="userSpaceOnUse">
      <rect width="20" height="20" fill="#f0f8e8"/>
      <line x1="0" y1="20" x2="20" y2="0" stroke="#d4edda" stroke-width="0.5"/>
    </pattern>
    
    <!-- Arrow markers -->
    <marker id="arrowhead" markerWidth="6" markerHeight="4" refX="5" refY="2" orient="auto">
      <polygon points="0 0, 6 2, 0 4" fill="#595959"/>
    </marker>
    
    <!-- Arrow marker for votes/certificates -->
    <marker id="votearrowhead" markerWidth="6" markerHeight="4" refX="5" refY="2" orient="auto">
      <polygon points="0 0, 6 2, 0 4" fill="#f9a825"/>
    </marker>
    
    <!-- Hover effects for interactive links -->
    <style>
      .mode-link, .block-link, .vote-link, .param-link {
        cursor: pointer;
      }
      .mode-link:hover rect {
        fill-opacity: 0.9;
        stroke-width: 1.5;
      }
      .mode-link:hover text {
        font-weight: bold;
      }
      .block-link:hover rect {
        stroke-width: 3;
        filter: brightness(1.1);
      }
      .block-link:hover polygon {
        stroke-width: 3;
        filter: brightness(1.1);
      }
      .block-link:hover text {
        font-weight: bold;
      }
      .vote-link:hover rect {
        transform: scale(2.0);
        filter: brightness(1.5) saturate(1.3);
        stroke: #ff6b35;
        stroke-width: 1;
      }
      .param-link:hover line,
      .param-link:hover path {
        stroke-width: 3;
        filter: brightness(1.1);
      }
      .param-link:hover text {
        font-weight: bold;
      }
    </style>
  </defs>
  
  <!-- Background -->
  <rect width="1200" height="500" fill="#ffffff"/>
  
  <!-- Mode Timeline (Top) - showing transition into Leios mode -->
  <g id="mode-timeline">
    <!-- Praos or Leios Mode (mixed) for announcement -->
    <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#praos-mode" class="mode-link">
      <rect x="50" y="40" width="650" height="40" fill="url(#praosPattern)" fill-opacity="0.6" stroke="#783f04" stroke-width="0.5" stroke-opacity="0.3"/>
    </a>
    <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#leios-mode" class="mode-link">
      <rect x="50" y="40" width="650" height="40" fill="url(#leiosPattern)" fill-opacity="0.3" stroke="#7cb342" stroke-width="0.5" stroke-opacity="0.3"/>
      <text x="375" y="60" dominant-baseline="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#666">Praos / Leios</text>
    </a>
    
    <!-- Leios Mode starts just before certificate -->
    <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#leios-mode" class="mode-link">
      <rect x="700" y="40" width="450" height="40" fill="url(#leiosPattern)" stroke="#7cb342" stroke-width="0.5" stroke-opacity="0.3"/>
      <text x="925" y="60" dominant-baseline="middle" font-family="Arial, sans-serif" font-size="20" font-weight="bold" text-anchor="middle" fill="#5a8030">Leios</text>
    </a>
  </g>
  
  <!-- Main chain extension content -->
  <g id="chain-extension">
<!-- Continuation dots -->
    <text x="260" y="181" font-family="Arial, sans-serif" font-size="28" fill="#666" text-anchor="middle">...</text>

    <!-- RB with EB announcement (could be in either mode) -->
    <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#ranking-blocks-rbs" class="block-link">
      <rect x="330" y="120" width="100" height="120" fill="#fce5cd" stroke="#783f04" stroke-width="2" rx="8"/>
      <text x="380" y="165" font-family="Arial, sans-serif" font-size="24" font-weight="bold" text-anchor="middle" fill="#783f04">RB</text>
      <text x="380" y="195" font-family="Arial, sans-serif" font-size="14" text-anchor="middle" fill="#783f04">[Txs]</text>
    </a>
    
    <!-- Arrow from RB to EB with "announces" label -->
    <path d="M 380 240 L 380 276" stroke="#783f04" stroke-width="2" stroke-dasharray="4,3" marker-end="url(#arrowhead)"/>
    <text x="385" y="260" font-family="Arial, sans-serif" font-size="14" text-anchor="start" fill="#783f04">announces</text>
    
    <!-- EB -->
    <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#endorser-blocks-ebs" class="block-link">
      <rect x="305" y="280" width="150" height="100" fill="#d9ead3" stroke="#274e13" stroke-width="2" rx="8"/>
      <text x="380" y="320" font-family="Arial, sans-serif" font-size="22" font-weight="bold" text-anchor="middle" fill="#274e13">EB</text>
      <text x="380" y="350" font-family="Arial, sans-serif" font-size="14" text-anchor="middle" fill="#274e13">[TxRefs]</text>
    </a>
    
    <!-- Arrow from predecessor (dashed) pointing to something off-screen -->
    <path d="M 330 180 L 290 180" stroke="#783f04" stroke-width="2" stroke-dasharray="4,3" marker-end="url(#arrowhead)"/>
    
    <!-- Solid arrow connecting the two RBs (pointing left to first RB) -->
    <path d="M 770 180 L 430 180" stroke="#783f04" stroke-width="2" marker-end="url(#arrowhead)"/>
    
    <!-- Voting phase indicators -->
    <g id="votes">
      <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#votes-and-certificates" class="vote-link">
        <rect x="540" y="210" width="8" height="8" fill="#f9a825" transform="rotate(45 544 214)"/>
      </a>
      <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#votes-and-certificates" class="vote-link">
        <rect x="560" y="220" width="8" height="8" fill="#f9a825" transform="rotate(45 564 224)"/>
      </a>
      <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#votes-and-certificates" class="vote-link">
        <rect x="580" y="205" width="8" height="8" fill="#f9a825" transform="rotate(45 584 209)"/>
      </a>
      <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#votes-and-certificates" class="vote-link">
        <rect x="600" y="215" width="8" height="8" fill="#f9a825" transform="rotate(45 604 219)"/>
      </a>
      <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#votes-and-certificates" class="vote-link">
        <rect x="620" y="210" width="8" height="8" fill="#f9a825" transform="rotate(45 624 214)"/>
      </a>
      <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#votes-and-certificates" class="vote-link">
        <rect x="640" y="220" width="8" height="8" fill="#f9a825" transform="rotate(45 644 224)"/>
      </a>
    </g>
    
    <!-- Vote arrows pointing to EB -->
    <path d="M 540 220 Q 480 280 455 330" stroke="#f9a825" stroke-width="1" stroke-dasharray="2,2" fill="none" marker-end="url(#votearrowhead)"/>
    <path d="M 560 230 Q 490 280 455 330" stroke="#f9a825" stroke-width="1" stroke-dasharray="2,2" fill="none" marker-end="url(#votearrowhead)"/>
    <path d="M 580 215 Q 500 280 455 330" stroke="#f9a825" stroke-width="1" stroke-dasharray="2,2" fill="none" marker-end="url(#votearrowhead)"/>
    <path d="M 600 225 Q 510 280 455 330" stroke="#f9a825" stroke-width="1" stroke-dasharray="2,2" fill="none" marker-end="url(#votearrowhead)"/>
    <path d="M 620 220 Q 520 280 455 330" stroke="#f9a825" stroke-width="1" stroke-dasharray="2,2" fill="none" marker-end="url(#votearrowhead)"/>
    <path d="M 640 230 Q 530 280 455 330" stroke="#f9a825" stroke-width="1" stroke-dasharray="2,2" fill="none" marker-end="url(#votearrowhead)"/>
    
    <!-- L_vote period indicator -->
    <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#l-vote" class="param-link">
      <line x1="520" y1="250" x2="660" y2="250" stroke="#f9a825" stroke-width="1" stroke-dasharray="4,4"/>
      <path d="M 520 250 L 520 255 Q 520 260 525 260 L 585 260 L 590 267 L 595 260 L 655 260 Q 660 260 660 255 L 660 250" 
            stroke="#f9a825" stroke-width="2" fill="none"/>
      <text x="590" y="280" font-size="18" text-anchor="middle" fill="#f9a825">
        <tspan font-family="serif" font-style="italic" font-size="24">L</tspan><tspan font-family="Arial, sans-serif" font-size="14" baseline-shift="sub">vote</tspan>
      </text>
    </a>
    
    <!-- RB with certificate -->
    <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#ranking-blocks-rbs" class="block-link">
      <rect x="770" y="120" width="100" height="120" fill="#fce5cd" stroke="#ff6b6b" stroke-width="2" rx="8" stroke-dasharray="5,5"/>
      <text x="820" y="165" font-family="Arial, sans-serif" font-size="24" font-weight="bold" text-anchor="middle" fill="#783f04">RB'</text>
      <text x="820" y="195" font-family="Arial, sans-serif" font-size="14" text-anchor="middle" fill="#783f04">[Txs]</text>
    </a>
    
    <!-- Certificate symbol -->
    <g transform="translate(820, 240)">
      <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#votes-and-certificates" class="block-link">
        <polygon points="0,-30 30,-15 30,15 0,30 -30,15 -30,-15" fill="#fff2cc" stroke="#f9a825" stroke-width="2"/>
        <text x="0" y="5" font-size="14" font-weight="bold" text-anchor="middle" fill="#7f6000">
          <tspan font-family="serif" font-style="italic" font-size="18">C</tspan><tspan font-family="Arial, sans-serif" font-size="12" font-style="normal" baseline-shift="sub">EB</tspan>
        </text>
      </a>
    </g>
    
    <!-- Arrow from certificate back to EB -->
    <path d="M 820 270 Q 720 330 455 330" stroke="#f9a825" stroke-width="2" stroke-dasharray="2,2" fill="none" marker-end="url(#votearrowhead)"/>
    
    <!-- Arrow from something off-screen to certificate RB (dashed) -->
    <path d="M 920 180 L 870 180" stroke="#783f04" stroke-width="2" stroke-dasharray="4,3" marker-end="url(#arrowhead)"/>
    
    <!-- Continuation dots -->
    <text x="950" y="181" font-family="Arial, sans-serif" font-size="28" fill="#666" text-anchor="middle">...</text>
  </g>
  
  <!-- Legend -->
  <g id="legend" transform="translate(340, 440)">
    <text x="280" y="0" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#333" text-anchor="middle">Legend</text>
    
    <!-- RB -->
    <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#ranking-blocks-rbs" class="block-link">
      <rect x="70" y="12" width="18" height="24" fill="#fce5cd" stroke="#783f04" stroke-width="1.5" rx="2"/>
    </a>
    <text x="98" y="28" font-family="Arial, sans-serif" font-size="14" fill="#333">Ranking Block (RB)</text>
    
    <!-- EB -->
    <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#endorser-blocks-ebs" class="block-link">
      <rect x="240" y="15" width="24" height="18" fill="#d9ead3" stroke="#274e13" stroke-width="1.5" rx="2"/>
    </a>
    <text x="270" y="28" font-family="Arial, sans-serif" font-size="14" fill="#333">Endorser Block (EB)</text>
    
    <!-- Certificate -->
    <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#votes-and-certificates" class="block-link">
      <polygon points="410,12 420,18 420,30 410,36 400,30 400,18" fill="#fff2cc" stroke="#f9a825" stroke-width="1"/>
    </a>
    <text x="428" y="28" font-family="Arial, sans-serif" font-size="14" fill="#333">Certificate</text>
    
    <!-- Vote -->
    <a href="https://github.com/input-output-hk/ouroboros-leios/blob/cip/review/docs/cip/README.md#votes-and-certificates" class="vote-link">
      <rect x="510" y="17" width="10" height="10" fill="#f9a825" transform="rotate(45 515 22)"/>
    </a>
    <text x="530" y="28" font-family="Arial, sans-serif" font-size="14" fill="#333">Vote</text>
  </g>
</svg>
