## Leios.VRF

This module defines the Verifiable Random Function (VRF) interface and
its use in the Leios protocol. It specifies the types and operations
for VRF evaluation, verification, and key management, as well as
predicates for block and vote eligibility based on VRF outputs.
The module also provides the Leios-specific VRF abstraction and
utility functions for protocol slot leader selection.
<!--
<pre class="Agda"><a id="415" class="Symbol">{-#</a> <a id="419" class="Keyword">OPTIONS</a> <a id="427" class="Pragma">--safe</a> <a id="434" class="Symbol">#-}</a>
</pre>-->
<pre class="Agda"><a id="454" class="Keyword">open</a> <a id="459" class="Keyword">import</a> <a id="466" href="Leios.Prelude.html" class="Module">Leios.Prelude</a>
<a id="480" class="Keyword">open</a> <a id="485" class="Keyword">import</a> <a id="492" href="Leios.Abstract.html" class="Module">Leios.Abstract</a>

<a id="508" class="Keyword">module</a> <a id="515" href="Leios.VRF.html" class="Module">Leios.VRF</a> <a id="525" class="Symbol">(</a><a id="526" href="Leios.VRF.html#526" class="Bound">a</a> <a id="528" class="Symbol">:</a> <a id="530" href="Leios.Abstract.html#452" class="Record">LeiosAbstract</a><a id="543" class="Symbol">)</a> <a id="545" class="Symbol">(</a><a id="546" class="Keyword">let</a> <a id="550" class="Keyword">open</a> <a id="555" href="Leios.Abstract.html#452" class="Module">LeiosAbstract</a> <a id="569" href="Leios.VRF.html#526" class="Bound">a</a><a id="570" class="Symbol">)</a> <a id="572" class="Keyword">where</a>

<a id="579" class="Keyword">record</a> <a id="VRF"></a><a id="586" href="Leios.VRF.html#586" class="Record">VRF</a> <a id="590" class="Symbol">(</a><a id="591" href="Leios.VRF.html#591" class="Bound">Dom</a> <a id="595" href="Leios.VRF.html#595" class="Bound">Range</a> <a id="601" href="Leios.VRF.html#601" class="Bound">PubKey</a> <a id="608" class="Symbol">:</a> <a id="610" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="614" class="Symbol">)</a> <a id="616" class="Symbol">:</a> <a id="618" href="Agda.Primitive.html#388" class="Primitive">Type₁</a> <a id="624" class="Keyword">where</a>
  <a id="632" class="Keyword">field</a> <a id="VRF.isKeyPair"></a><a id="638" href="Leios.VRF.html#638" class="Field">isKeyPair</a> <a id="648" class="Symbol">:</a> <a id="650" href="Leios.VRF.html#601" class="Bound">PubKey</a> <a id="657" class="Symbol">→</a> <a id="659" href="Leios.Abstract.html#584" class="Field">PrivKey</a> <a id="667" class="Symbol">→</a> <a id="669" href="Agda.Primitive.html#388" class="Primitive">Type</a>
        <a id="VRF.eval"></a><a id="682" href="Leios.VRF.html#682" class="Field">eval</a> <a id="687" class="Symbol">:</a> <a id="689" href="Leios.Abstract.html#584" class="Field">PrivKey</a> <a id="697" class="Symbol">→</a> <a id="699" href="Leios.VRF.html#591" class="Bound">Dom</a> <a id="703" class="Symbol">→</a> <a id="705" href="Leios.VRF.html#595" class="Bound">Range</a> <a id="711" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="713" href="Leios.Abstract.html#560" class="Field">VrfPf</a>
        <a id="VRF.verify"></a><a id="727" href="Leios.VRF.html#727" class="Field">verify</a> <a id="734" class="Symbol">:</a> <a id="736" href="Leios.VRF.html#601" class="Bound">PubKey</a> <a id="743" class="Symbol">→</a> <a id="745" href="Leios.VRF.html#591" class="Bound">Dom</a> <a id="749" class="Symbol">→</a> <a id="751" href="Leios.VRF.html#595" class="Bound">Range</a> <a id="757" class="Symbol">→</a> <a id="759" href="Leios.Abstract.html#560" class="Field">VrfPf</a> <a id="765" class="Symbol">→</a> <a id="767" href="Agda.Primitive.html#388" class="Primitive">Type</a>
        <a id="VRF.verify?"></a><a id="780" href="Leios.VRF.html#780" class="Field">verify?</a> <a id="788" class="Symbol">:</a> <a id="790" class="Symbol">(</a><a id="791" href="Leios.VRF.html#791" class="Bound">pk</a> <a id="794" class="Symbol">:</a> <a id="796" href="Leios.VRF.html#601" class="Bound">PubKey</a><a id="802" class="Symbol">)</a> <a id="804" class="Symbol">→</a> <a id="806" class="Symbol">(</a><a id="807" href="Leios.VRF.html#807" class="Bound">d</a> <a id="809" class="Symbol">:</a> <a id="811" href="Leios.VRF.html#591" class="Bound">Dom</a><a id="814" class="Symbol">)</a> <a id="816" class="Symbol">→</a> <a id="818" class="Symbol">(</a><a id="819" href="Leios.VRF.html#819" class="Bound">r</a> <a id="821" class="Symbol">:</a> <a id="823" href="Leios.VRF.html#595" class="Bound">Range</a><a id="828" class="Symbol">)</a> <a id="830" class="Symbol">→</a> <a id="832" class="Symbol">(</a><a id="833" href="Leios.VRF.html#833" class="Bound">pf</a> <a id="836" class="Symbol">:</a> <a id="838" href="Leios.Abstract.html#560" class="Field">VrfPf</a><a id="843" class="Symbol">)</a> <a id="845" class="Symbol">→</a> <a id="847" href="Relation.Nullary.Decidable.Core.html#1966" class="Record">Dec</a> <a id="851" class="Symbol">(</a><a id="852" href="Leios.VRF.html#727" class="Field">verify</a> <a id="859" href="Leios.VRF.html#791" class="Bound">pk</a> <a id="862" href="Leios.VRF.html#807" class="Bound">d</a> <a id="864" href="Leios.VRF.html#819" class="Bound">r</a> <a id="866" href="Leios.VRF.html#833" class="Bound">pf</a><a id="868" class="Symbol">)</a>

<a id="871" class="Keyword">record</a> <a id="LeiosVRF"></a><a id="878" href="Leios.VRF.html#878" class="Record">LeiosVRF</a> <a id="887" class="Symbol">:</a> <a id="889" href="Agda.Primitive.html#388" class="Primitive">Type₁</a> <a id="895" class="Keyword">where</a>
  <a id="903" class="Keyword">field</a> <a id="LeiosVRF.PubKey"></a><a id="909" href="Leios.VRF.html#909" class="Field">PubKey</a> <a id="916" class="Symbol">:</a> <a id="918" href="Agda.Primitive.html#388" class="Primitive">Type</a>
        <a id="LeiosVRF.poolID"></a><a id="931" href="Leios.VRF.html#931" class="Field">poolID</a> <a id="938" class="Symbol">:</a> <a id="940" href="Leios.VRF.html#909" class="Field">PubKey</a> <a id="947" class="Symbol">→</a> <a id="949" href="Leios.Abstract.html#512" class="Field">PoolID</a>
        <a id="LeiosVRF.verifySig"></a><a id="964" href="Leios.VRF.html#964" class="Field">verifySig</a> <a id="974" class="Symbol">:</a> <a id="976" href="Leios.VRF.html#909" class="Field">PubKey</a> <a id="983" class="Symbol">→</a> <a id="985" href="Leios.Abstract.html#608" class="Field">Sig</a> <a id="989" class="Symbol">→</a> <a id="991" href="Agda.Primitive.html#388" class="Primitive">Type</a>
        <a id="LeiosVRF.verifySig?"></a><a id="1004" href="Leios.VRF.html#1004" class="Field">verifySig?</a> <a id="1015" class="Symbol">:</a> <a id="1017" class="Symbol">(</a><a id="1018" href="Leios.VRF.html#1018" class="Bound">pk</a> <a id="1021" class="Symbol">:</a> <a id="1023" href="Leios.VRF.html#909" class="Field">PubKey</a><a id="1029" class="Symbol">)</a> <a id="1031" class="Symbol">→</a> <a id="1033" class="Symbol">(</a><a id="1034" href="Leios.VRF.html#1034" class="Bound">sig</a> <a id="1038" class="Symbol">:</a> <a id="1040" href="Leios.Abstract.html#608" class="Field">Sig</a><a id="1043" class="Symbol">)</a> <a id="1045" class="Symbol">→</a> <a id="1047" href="Relation.Nullary.Decidable.Core.html#1966" class="Record">Dec</a> <a id="1051" class="Symbol">(</a><a id="1052" href="Leios.VRF.html#964" class="Field">verifySig</a> <a id="1062" href="Leios.VRF.html#1018" class="Bound">pk</a> <a id="1065" href="Leios.VRF.html#1034" class="Bound">sig</a><a id="1068" class="Symbol">)</a>

        <a id="LeiosVRF.vrf"></a><a id="1079" href="Leios.VRF.html#1079" class="Field">vrf</a> <a id="1083" class="Symbol">:</a> <a id="1085" href="Leios.VRF.html#586" class="Record">VRF</a> <a id="1089" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="1091" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="1093" href="Leios.VRF.html#909" class="Field">PubKey</a>

  <a id="1103" class="Keyword">open</a> <a id="1108" href="Leios.VRF.html#586" class="Module">VRF</a> <a id="1112" href="Leios.VRF.html#1079" class="Field">vrf</a> <a id="1116" class="Keyword">public</a>

  <a id="1126" class="Comment">-- transforming slot numbers into VRF seeds</a>
  <a id="1172" class="Keyword">field</a> <a id="LeiosVRF.genIBInput"></a><a id="1178" href="Leios.VRF.html#1178" class="Field">genIBInput</a> <a id="LeiosVRF.genEBInput"></a><a id="1189" href="Leios.VRF.html#1189" class="Field">genEBInput</a> <a id="LeiosVRF.genVInput"></a><a id="1200" href="Leios.VRF.html#1200" class="Field">genVInput</a> <a id="LeiosVRF.genV1Input"></a><a id="1210" href="Leios.VRF.html#1210" class="Field">genV1Input</a> <a id="LeiosVRF.genV2Input"></a><a id="1221" href="Leios.VRF.html#1221" class="Field">genV2Input</a> <a id="1232" class="Symbol">:</a> <a id="1234" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="1236" class="Symbol">→</a> <a id="1238" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>

  <a id="LeiosVRF.canProduceIB"></a><a id="1243" href="Leios.VRF.html#1243" class="Function">canProduceIB</a> <a id="1256" class="Symbol">:</a> <a id="1258" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="1260" class="Symbol">→</a> <a id="1262" href="Leios.Abstract.html#584" class="Field">PrivKey</a> <a id="1270" class="Symbol">→</a> <a id="1272" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="1274" class="Symbol">→</a> <a id="1276" href="Leios.Abstract.html#560" class="Field">VrfPf</a> <a id="1282" class="Symbol">→</a> <a id="1284" href="Agda.Primitive.html#388" class="Primitive">Type</a>
  <a id="1291" href="Leios.VRF.html#1243" class="Function">canProduceIB</a> <a id="1304" href="Leios.VRF.html#1304" class="Bound">slot</a> <a id="1309" href="Leios.VRF.html#1309" class="Bound">k</a> <a id="1311" href="Leios.VRF.html#1311" class="Bound">stake</a> <a id="1317" href="Leios.VRF.html#1317" class="Bound">π</a> <a id="1319" class="Symbol">=</a> <a id="1321" class="Keyword">let</a> <a id="1325" class="Symbol">(</a><a id="1326" href="Leios.VRF.html#1326" class="Bound">val</a> <a id="1330" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1332" href="Leios.VRF.html#1332" class="Bound">pf</a><a id="1334" class="Symbol">)</a> <a id="1336" class="Symbol">=</a> <a id="1338" href="Leios.VRF.html#682" class="Function">eval</a> <a id="1343" href="Leios.VRF.html#1309" class="Bound">k</a> <a id="1345" class="Symbol">(</a><a id="1346" href="Leios.VRF.html#1178" class="Field">genIBInput</a> <a id="1357" href="Leios.VRF.html#1304" class="Bound">slot</a><a id="1361" class="Symbol">)</a> <a id="1363" class="Keyword">in</a> <a id="1366" href="Leios.VRF.html#1326" class="Bound">val</a> <a id="1370" href="Class.HasOrder.Core.html#646" class="Field Operator">&lt;</a> <a id="1372" href="Leios.VRF.html#1311" class="Bound">stake</a> <a id="1378" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1380" href="Leios.VRF.html#1332" class="Bound">pf</a> <a id="1383" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1385" href="Leios.VRF.html#1317" class="Bound">π</a>

  <a id="LeiosVRF.Dec-canProduceIB"></a><a id="1390" href="Leios.VRF.html#1390" class="Function">Dec-canProduceIB</a> <a id="1407" class="Symbol">:</a> <a id="1409" class="Symbol">∀</a> <a id="1411" class="Symbol">{</a><a id="1412" href="Leios.VRF.html#1412" class="Bound">slot</a> <a id="1417" href="Leios.VRF.html#1417" class="Bound">k</a> <a id="1419" href="Leios.VRF.html#1419" class="Bound">stake</a><a id="1424" class="Symbol">}</a> <a id="1426" class="Symbol">→</a> <a id="1428" class="Symbol">(</a><a id="1429" href="Data.Product.Base.html#1371" class="Function">∃[</a> <a id="1432" href="Leios.VRF.html#1432" class="Bound">π</a> <a id="1434" href="Data.Product.Base.html#1371" class="Function">]</a> <a id="1436" href="Leios.VRF.html#1243" class="Function">canProduceIB</a> <a id="1449" href="Leios.VRF.html#1412" class="Bound">slot</a> <a id="1454" href="Leios.VRF.html#1417" class="Bound">k</a> <a id="1456" href="Leios.VRF.html#1419" class="Bound">stake</a> <a id="1462" href="Leios.VRF.html#1432" class="Bound">π</a><a id="1463" class="Symbol">)</a> <a id="1465" href="Data.Sum.Base.html#625" class="Datatype Operator">⊎</a> <a id="1467" class="Symbol">(∀</a> <a id="1470" href="Leios.VRF.html#1470" class="Bound">π</a> <a id="1472" class="Symbol">→</a> <a id="1474" href="Relation.Nullary.Negation.Core.html#677" class="Function Operator">¬</a> <a id="1476" href="Leios.VRF.html#1243" class="Function">canProduceIB</a> <a id="1489" href="Leios.VRF.html#1412" class="Bound">slot</a> <a id="1494" href="Leios.VRF.html#1417" class="Bound">k</a> <a id="1496" href="Leios.VRF.html#1419" class="Bound">stake</a> <a id="1502" href="Leios.VRF.html#1470" class="Bound">π</a><a id="1503" class="Symbol">)</a>
  <a id="1507" href="Leios.VRF.html#1390" class="Function">Dec-canProduceIB</a> <a id="1524" class="Symbol">{</a><a id="1525" href="Leios.VRF.html#1525" class="Bound">slot</a><a id="1529" class="Symbol">}</a> <a id="1531" class="Symbol">{</a><a id="1532" href="Leios.VRF.html#1532" class="Bound">k</a><a id="1533" class="Symbol">}</a> <a id="1535" class="Symbol">{</a><a id="1536" href="Leios.VRF.html#1536" class="Bound">stake</a><a id="1541" class="Symbol">}</a> <a id="1543" class="Keyword">with</a> <a id="1548" href="Leios.VRF.html#682" class="Function">eval</a> <a id="1553" href="Leios.VRF.html#1532" class="Bound">k</a> <a id="1555" class="Symbol">(</a><a id="1556" href="Leios.VRF.html#1178" class="Field">genIBInput</a> <a id="1567" href="Leios.VRF.html#1525" class="Bound">slot</a><a id="1571" class="Symbol">)</a>
  <a id="1575" class="Symbol">...</a> <a id="1579" class="Symbol">|</a> <a id="1581" class="Symbol">(</a><a id="1582" href="Leios.VRF.html#1582" class="Bound">val</a> <a id="1586" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1588" href="Leios.VRF.html#1588" class="Bound">pf</a><a id="1590" class="Symbol">)</a> <a id="1592" class="Symbol">=</a> <a id="1594" href="Function.Base.html#4061" class="Function Operator">case</a> <a id="1599" href="Class.Decidable.Core.html#470" class="Function Operator">¿</a> <a id="1601" href="Leios.VRF.html#1582" class="Bound">val</a> <a id="1605" href="Class.HasOrder.Core.html#646" class="Field Operator">&lt;</a> <a id="1607" class="Bound">stake</a> <a id="1613" href="Class.Decidable.Core.html#470" class="Function Operator">¿</a> <a id="1615" href="Function.Base.html#4061" class="Function Operator">of</a> <a id="1618" class="Symbol">λ</a> <a id="1620" class="Keyword">where</a>
    <a id="1630" class="Symbol">(</a><a id="1631" href="Relation.Nullary.Decidable.Core.html#2099" class="InductiveConstructor">yes</a> <a id="1635" href="Leios.VRF.html#1635" class="Bound">p</a><a id="1636" class="Symbol">)</a> <a id="1638" class="Symbol">→</a> <a id="1640" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="1645" class="Symbol">(</a><a id="1646" href="Leios.VRF.html#1588" class="Bound">pf</a> <a id="1649" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1651" href="Leios.VRF.html#1635" class="Bound">p</a> <a id="1653" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1655" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="1659" class="Symbol">)</a>
    <a id="1665" class="Symbol">(</a><a id="1666" href="Relation.Nullary.Decidable.Core.html#2136" class="InductiveConstructor">no</a> <a id="1669" href="Leios.VRF.html#1669" class="Bound">¬p</a><a id="1671" class="Symbol">)</a> <a id="1673" class="Symbol">→</a> <a id="1675" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="1680" class="Symbol">(λ</a> <a id="1683" href="Leios.VRF.html#1683" class="Bound">π</a> <a id="1685" class="Symbol">(</a><a id="1686" href="Leios.VRF.html#1686" class="Bound">h</a> <a id="1688" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1690" class="Symbol">_)</a> <a id="1693" class="Symbol">→</a> <a id="1695" href="Leios.VRF.html#1669" class="Bound">¬p</a> <a id="1698" href="Leios.VRF.html#1686" class="Bound">h</a><a id="1699" class="Symbol">)</a>

  <a id="LeiosVRF.canProduceIBPub"></a><a id="1704" href="Leios.VRF.html#1704" class="Function">canProduceIBPub</a> <a id="1720" class="Symbol">:</a> <a id="1722" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="1724" class="Symbol">→</a> <a id="1726" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="1728" class="Symbol">→</a> <a id="1730" href="Leios.VRF.html#909" class="Field">PubKey</a> <a id="1737" class="Symbol">→</a> <a id="1739" href="Leios.Abstract.html#560" class="Field">VrfPf</a> <a id="1745" class="Symbol">→</a> <a id="1747" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="1749" class="Symbol">→</a> <a id="1751" href="Agda.Primitive.html#388" class="Primitive">Type</a>
  <a id="1758" href="Leios.VRF.html#1704" class="Function">canProduceIBPub</a> <a id="1774" href="Leios.VRF.html#1774" class="Bound">slot</a> <a id="1779" href="Leios.VRF.html#1779" class="Bound">val</a> <a id="1783" href="Leios.VRF.html#1783" class="Bound">k</a> <a id="1785" href="Leios.VRF.html#1785" class="Bound">pf</a> <a id="1788" href="Leios.VRF.html#1788" class="Bound">stake</a> <a id="1794" class="Symbol">=</a> <a id="1796" href="Leios.VRF.html#727" class="Function">verify</a> <a id="1803" href="Leios.VRF.html#1783" class="Bound">k</a> <a id="1805" class="Symbol">(</a><a id="1806" href="Leios.VRF.html#1178" class="Field">genIBInput</a> <a id="1817" href="Leios.VRF.html#1774" class="Bound">slot</a><a id="1821" class="Symbol">)</a> <a id="1823" href="Leios.VRF.html#1779" class="Bound">val</a> <a id="1827" href="Leios.VRF.html#1785" class="Bound">pf</a> <a id="1830" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1832" href="Leios.VRF.html#1779" class="Bound">val</a> <a id="1836" href="Class.HasOrder.Core.html#646" class="Field Operator">&lt;</a> <a id="1838" href="Leios.VRF.html#1788" class="Bound">stake</a>

  <a id="LeiosVRF.canProduceEB"></a><a id="1847" href="Leios.VRF.html#1847" class="Function">canProduceEB</a> <a id="1860" class="Symbol">:</a> <a id="1862" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="1864" class="Symbol">→</a> <a id="1866" href="Leios.Abstract.html#584" class="Field">PrivKey</a> <a id="1874" class="Symbol">→</a> <a id="1876" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="1878" class="Symbol">→</a> <a id="1880" href="Leios.Abstract.html#560" class="Field">VrfPf</a> <a id="1886" class="Symbol">→</a> <a id="1888" href="Agda.Primitive.html#388" class="Primitive">Type</a>
  <a id="1895" href="Leios.VRF.html#1847" class="Function">canProduceEB</a> <a id="1908" href="Leios.VRF.html#1908" class="Bound">slot</a> <a id="1913" href="Leios.VRF.html#1913" class="Bound">k</a> <a id="1915" href="Leios.VRF.html#1915" class="Bound">stake</a> <a id="1921" href="Leios.VRF.html#1921" class="Bound">π</a> <a id="1923" class="Symbol">=</a> <a id="1925" class="Keyword">let</a> <a id="1929" class="Symbol">(</a><a id="1930" href="Leios.VRF.html#1930" class="Bound">val</a> <a id="1934" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1936" href="Leios.VRF.html#1936" class="Bound">pf</a><a id="1938" class="Symbol">)</a> <a id="1940" class="Symbol">=</a> <a id="1942" href="Leios.VRF.html#682" class="Function">eval</a> <a id="1947" href="Leios.VRF.html#1913" class="Bound">k</a> <a id="1949" class="Symbol">(</a><a id="1950" href="Leios.VRF.html#1189" class="Field">genEBInput</a> <a id="1961" href="Leios.VRF.html#1908" class="Bound">slot</a><a id="1965" class="Symbol">)</a> <a id="1967" class="Keyword">in</a> <a id="1970" href="Leios.VRF.html#1930" class="Bound">val</a> <a id="1974" href="Class.HasOrder.Core.html#646" class="Field Operator">&lt;</a> <a id="1976" href="Leios.VRF.html#1915" class="Bound">stake</a> <a id="1982" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1984" href="Leios.VRF.html#1936" class="Bound">pf</a> <a id="1987" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1989" href="Leios.VRF.html#1921" class="Bound">π</a>

  <a id="LeiosVRF.Dec-canProduceEB"></a><a id="1994" href="Leios.VRF.html#1994" class="Function">Dec-canProduceEB</a> <a id="2011" class="Symbol">:</a> <a id="2013" class="Symbol">∀</a> <a id="2015" class="Symbol">{</a><a id="2016" href="Leios.VRF.html#2016" class="Bound">slot</a> <a id="2021" href="Leios.VRF.html#2021" class="Bound">k</a> <a id="2023" href="Leios.VRF.html#2023" class="Bound">stake</a><a id="2028" class="Symbol">}</a> <a id="2030" class="Symbol">→</a> <a id="2032" class="Symbol">(</a><a id="2033" href="Data.Product.Base.html#1371" class="Function">∃[</a> <a id="2036" href="Leios.VRF.html#2036" class="Bound">π</a> <a id="2038" href="Data.Product.Base.html#1371" class="Function">]</a> <a id="2040" href="Leios.VRF.html#1847" class="Function">canProduceEB</a> <a id="2053" href="Leios.VRF.html#2016" class="Bound">slot</a> <a id="2058" href="Leios.VRF.html#2021" class="Bound">k</a> <a id="2060" href="Leios.VRF.html#2023" class="Bound">stake</a> <a id="2066" href="Leios.VRF.html#2036" class="Bound">π</a><a id="2067" class="Symbol">)</a> <a id="2069" href="Data.Sum.Base.html#625" class="Datatype Operator">⊎</a> <a id="2071" class="Symbol">(∀</a> <a id="2074" href="Leios.VRF.html#2074" class="Bound">π</a> <a id="2076" class="Symbol">→</a> <a id="2078" href="Relation.Nullary.Negation.Core.html#677" class="Function Operator">¬</a> <a id="2080" href="Leios.VRF.html#1847" class="Function">canProduceEB</a> <a id="2093" href="Leios.VRF.html#2016" class="Bound">slot</a> <a id="2098" href="Leios.VRF.html#2021" class="Bound">k</a> <a id="2100" href="Leios.VRF.html#2023" class="Bound">stake</a> <a id="2106" href="Leios.VRF.html#2074" class="Bound">π</a><a id="2107" class="Symbol">)</a>
  <a id="2111" href="Leios.VRF.html#1994" class="Function">Dec-canProduceEB</a> <a id="2128" class="Symbol">{</a><a id="2129" href="Leios.VRF.html#2129" class="Bound">slot</a><a id="2133" class="Symbol">}</a> <a id="2135" class="Symbol">{</a><a id="2136" href="Leios.VRF.html#2136" class="Bound">k</a><a id="2137" class="Symbol">}</a> <a id="2139" class="Symbol">{</a><a id="2140" href="Leios.VRF.html#2140" class="Bound">stake</a><a id="2145" class="Symbol">}</a> <a id="2147" class="Keyword">with</a> <a id="2152" href="Leios.VRF.html#682" class="Function">eval</a> <a id="2157" href="Leios.VRF.html#2136" class="Bound">k</a> <a id="2159" class="Symbol">(</a><a id="2160" href="Leios.VRF.html#1189" class="Field">genEBInput</a> <a id="2171" href="Leios.VRF.html#2129" class="Bound">slot</a><a id="2175" class="Symbol">)</a>
  <a id="2179" class="Symbol">...</a> <a id="2183" class="Symbol">|</a> <a id="2185" class="Symbol">(</a><a id="2186" href="Leios.VRF.html#2186" class="Bound">val</a> <a id="2190" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2192" href="Leios.VRF.html#2192" class="Bound">pf</a><a id="2194" class="Symbol">)</a> <a id="2196" class="Symbol">=</a> <a id="2198" href="Function.Base.html#4061" class="Function Operator">case</a> <a id="2203" href="Class.Decidable.Core.html#470" class="Function Operator">¿</a> <a id="2205" href="Leios.VRF.html#2186" class="Bound">val</a> <a id="2209" href="Class.HasOrder.Core.html#646" class="Field Operator">&lt;</a> <a id="2211" class="Bound">stake</a> <a id="2217" href="Class.Decidable.Core.html#470" class="Function Operator">¿</a> <a id="2219" href="Function.Base.html#4061" class="Function Operator">of</a> <a id="2222" class="Symbol">λ</a> <a id="2224" class="Keyword">where</a>
    <a id="2234" class="Symbol">(</a><a id="2235" href="Relation.Nullary.Decidable.Core.html#2099" class="InductiveConstructor">yes</a> <a id="2239" href="Leios.VRF.html#2239" class="Bound">p</a><a id="2240" class="Symbol">)</a> <a id="2242" class="Symbol">→</a> <a id="2244" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="2249" class="Symbol">(</a><a id="2250" href="Leios.VRF.html#2192" class="Bound">pf</a> <a id="2253" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2255" href="Leios.VRF.html#2239" class="Bound">p</a> <a id="2257" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2259" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="2263" class="Symbol">)</a>
    <a id="2269" class="Symbol">(</a><a id="2270" href="Relation.Nullary.Decidable.Core.html#2136" class="InductiveConstructor">no</a> <a id="2273" href="Leios.VRF.html#2273" class="Bound">¬p</a><a id="2275" class="Symbol">)</a> <a id="2277" class="Symbol">→</a> <a id="2279" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="2284" class="Symbol">(λ</a> <a id="2287" href="Leios.VRF.html#2287" class="Bound">π</a> <a id="2289" class="Symbol">(</a><a id="2290" href="Leios.VRF.html#2290" class="Bound">h</a> <a id="2292" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2294" class="Symbol">_)</a> <a id="2297" class="Symbol">→</a> <a id="2299" href="Leios.VRF.html#2273" class="Bound">¬p</a> <a id="2302" href="Leios.VRF.html#2290" class="Bound">h</a><a id="2303" class="Symbol">)</a>

  <a id="LeiosVRF.canProduceEBPub"></a><a id="2308" href="Leios.VRF.html#2308" class="Function">canProduceEBPub</a> <a id="2324" class="Symbol">:</a> <a id="2326" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="2328" class="Symbol">→</a> <a id="2330" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="2332" class="Symbol">→</a> <a id="2334" href="Leios.VRF.html#909" class="Field">PubKey</a> <a id="2341" class="Symbol">→</a> <a id="2343" href="Leios.Abstract.html#560" class="Field">VrfPf</a> <a id="2349" class="Symbol">→</a> <a id="2351" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="2353" class="Symbol">→</a> <a id="2355" href="Agda.Primitive.html#388" class="Primitive">Type</a>
  <a id="2362" href="Leios.VRF.html#2308" class="Function">canProduceEBPub</a> <a id="2378" href="Leios.VRF.html#2378" class="Bound">slot</a> <a id="2383" href="Leios.VRF.html#2383" class="Bound">val</a> <a id="2387" href="Leios.VRF.html#2387" class="Bound">k</a> <a id="2389" href="Leios.VRF.html#2389" class="Bound">pf</a> <a id="2392" href="Leios.VRF.html#2392" class="Bound">stake</a> <a id="2398" class="Symbol">=</a> <a id="2400" href="Leios.VRF.html#727" class="Function">verify</a> <a id="2407" href="Leios.VRF.html#2387" class="Bound">k</a> <a id="2409" class="Symbol">(</a><a id="2410" href="Leios.VRF.html#1189" class="Field">genEBInput</a> <a id="2421" href="Leios.VRF.html#2378" class="Bound">slot</a><a id="2425" class="Symbol">)</a> <a id="2427" href="Leios.VRF.html#2383" class="Bound">val</a> <a id="2431" href="Leios.VRF.html#2389" class="Bound">pf</a> <a id="2434" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="2436" href="Leios.VRF.html#2383" class="Bound">val</a> <a id="2440" href="Class.HasOrder.Core.html#646" class="Field Operator">&lt;</a> <a id="2442" href="Leios.VRF.html#2392" class="Bound">stake</a>

  <a id="LeiosVRF.canProduceV"></a><a id="2451" href="Leios.VRF.html#2451" class="Function">canProduceV</a> <a id="2463" class="Symbol">:</a> <a id="2465" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="2467" class="Symbol">→</a> <a id="2469" href="Leios.Abstract.html#584" class="Field">PrivKey</a> <a id="2477" class="Symbol">→</a> <a id="2479" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="2481" class="Symbol">→</a> <a id="2483" href="Agda.Primitive.html#388" class="Primitive">Type</a>
  <a id="2490" href="Leios.VRF.html#2451" class="Function">canProduceV</a> <a id="2502" href="Leios.VRF.html#2502" class="Bound">slot</a> <a id="2507" href="Leios.VRF.html#2507" class="Bound">k</a> <a id="2509" href="Leios.VRF.html#2509" class="Bound">stake</a> <a id="2515" class="Symbol">=</a> <a id="2517" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="2523" class="Symbol">(</a><a id="2524" href="Leios.VRF.html#682" class="Function">eval</a> <a id="2529" href="Leios.VRF.html#2507" class="Bound">k</a> <a id="2531" class="Symbol">(</a><a id="2532" href="Leios.VRF.html#1200" class="Field">genVInput</a> <a id="2542" href="Leios.VRF.html#2502" class="Bound">slot</a><a id="2546" class="Symbol">))</a> <a id="2549" href="Class.HasOrder.Core.html#646" class="Field Operator">&lt;</a> <a id="2551" href="Leios.VRF.html#2509" class="Bound">stake</a>

  <a id="LeiosVRF.Dec-canProduceV"></a><a id="2560" href="Leios.VRF.html#2560" class="Function">Dec-canProduceV</a> <a id="2576" class="Symbol">:</a> <a id="2578" class="Symbol">∀</a> <a id="2580" class="Symbol">{</a><a id="2581" href="Leios.VRF.html#2581" class="Bound">slot</a> <a id="2586" href="Leios.VRF.html#2586" class="Bound">k</a> <a id="2588" href="Leios.VRF.html#2588" class="Bound">stake</a><a id="2593" class="Symbol">}</a> <a id="2595" class="Symbol">→</a> <a id="2597" href="Relation.Nullary.Decidable.Core.html#1966" class="Record">Dec</a> <a id="2601" class="Symbol">(</a><a id="2602" href="Leios.VRF.html#2451" class="Function">canProduceV</a> <a id="2614" href="Leios.VRF.html#2581" class="Bound">slot</a> <a id="2619" href="Leios.VRF.html#2586" class="Bound">k</a> <a id="2621" href="Leios.VRF.html#2588" class="Bound">stake</a><a id="2626" class="Symbol">)</a>
  <a id="2630" href="Leios.VRF.html#2560" class="Function">Dec-canProduceV</a> <a id="2646" class="Symbol">{</a><a id="2647" href="Leios.VRF.html#2647" class="Bound">slot</a><a id="2651" class="Symbol">}</a> <a id="2653" class="Symbol">{</a><a id="2654" href="Leios.VRF.html#2654" class="Bound">k</a><a id="2655" class="Symbol">}</a> <a id="2657" class="Symbol">{</a><a id="2658" href="Leios.VRF.html#2658" class="Bound">stake</a><a id="2663" class="Symbol">}</a> <a id="2665" class="Keyword">with</a> <a id="2670" href="Leios.VRF.html#682" class="Function">eval</a> <a id="2675" href="Leios.VRF.html#2654" class="Bound">k</a> <a id="2677" class="Symbol">(</a><a id="2678" href="Leios.VRF.html#1200" class="Field">genVInput</a> <a id="2688" href="Leios.VRF.html#2647" class="Bound">slot</a><a id="2692" class="Symbol">)</a>
  <a id="2696" class="Symbol">...</a> <a id="2700" class="Symbol">|</a> <a id="2702" class="Symbol">(</a><a id="2703" href="Leios.VRF.html#2703" class="Bound">val</a> <a id="2707" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2709" href="Leios.VRF.html#2709" class="Bound">pf</a><a id="2711" class="Symbol">)</a> <a id="2713" class="Symbol">=</a> <a id="2715" href="Class.Decidable.Core.html#470" class="Function Operator">¿</a> <a id="2717" href="Leios.VRF.html#2703" class="Bound">val</a> <a id="2721" href="Class.HasOrder.Core.html#646" class="Field Operator">&lt;</a> <a id="2723" class="Bound">stake</a> <a id="2729" href="Class.Decidable.Core.html#470" class="Function Operator">¿</a>

  <a id="LeiosVRF.canProduceV1"></a><a id="2734" href="Leios.VRF.html#2734" class="Function">canProduceV1</a> <a id="2747" class="Symbol">:</a> <a id="2749" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="2751" class="Symbol">→</a> <a id="2753" href="Leios.Abstract.html#584" class="Field">PrivKey</a> <a id="2761" class="Symbol">→</a> <a id="2763" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="2765" class="Symbol">→</a> <a id="2767" href="Agda.Primitive.html#388" class="Primitive">Type</a>
  <a id="2774" href="Leios.VRF.html#2734" class="Function">canProduceV1</a> <a id="2787" href="Leios.VRF.html#2787" class="Bound">slot</a> <a id="2792" href="Leios.VRF.html#2792" class="Bound">k</a> <a id="2794" href="Leios.VRF.html#2794" class="Bound">stake</a> <a id="2800" class="Symbol">=</a> <a id="2802" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="2808" class="Symbol">(</a><a id="2809" href="Leios.VRF.html#682" class="Function">eval</a> <a id="2814" href="Leios.VRF.html#2792" class="Bound">k</a> <a id="2816" class="Symbol">(</a><a id="2817" href="Leios.VRF.html#1210" class="Field">genV1Input</a> <a id="2828" href="Leios.VRF.html#2787" class="Bound">slot</a><a id="2832" class="Symbol">))</a> <a id="2835" href="Class.HasOrder.Core.html#646" class="Field Operator">&lt;</a> <a id="2837" href="Leios.VRF.html#2794" class="Bound">stake</a>

  <a id="LeiosVRF.Dec-canProduceV1"></a><a id="2846" href="Leios.VRF.html#2846" class="Function">Dec-canProduceV1</a> <a id="2863" class="Symbol">:</a> <a id="2865" class="Symbol">∀</a> <a id="2867" class="Symbol">{</a><a id="2868" href="Leios.VRF.html#2868" class="Bound">slot</a> <a id="2873" href="Leios.VRF.html#2873" class="Bound">k</a> <a id="2875" href="Leios.VRF.html#2875" class="Bound">stake</a><a id="2880" class="Symbol">}</a> <a id="2882" class="Symbol">→</a> <a id="2884" href="Relation.Nullary.Decidable.Core.html#1966" class="Record">Dec</a> <a id="2888" class="Symbol">(</a><a id="2889" href="Leios.VRF.html#2734" class="Function">canProduceV1</a> <a id="2902" href="Leios.VRF.html#2868" class="Bound">slot</a> <a id="2907" href="Leios.VRF.html#2873" class="Bound">k</a> <a id="2909" href="Leios.VRF.html#2875" class="Bound">stake</a><a id="2914" class="Symbol">)</a>
  <a id="2918" href="Leios.VRF.html#2846" class="Function">Dec-canProduceV1</a> <a id="2935" class="Symbol">{</a><a id="2936" href="Leios.VRF.html#2936" class="Bound">slot</a><a id="2940" class="Symbol">}</a> <a id="2942" class="Symbol">{</a><a id="2943" href="Leios.VRF.html#2943" class="Bound">k</a><a id="2944" class="Symbol">}</a> <a id="2946" class="Symbol">{</a><a id="2947" href="Leios.VRF.html#2947" class="Bound">stake</a><a id="2952" class="Symbol">}</a> <a id="2954" class="Keyword">with</a> <a id="2959" href="Leios.VRF.html#682" class="Function">eval</a> <a id="2964" href="Leios.VRF.html#2943" class="Bound">k</a> <a id="2966" class="Symbol">(</a><a id="2967" href="Leios.VRF.html#1210" class="Field">genV1Input</a> <a id="2978" href="Leios.VRF.html#2936" class="Bound">slot</a><a id="2982" class="Symbol">)</a>
  <a id="2986" class="Symbol">...</a> <a id="2990" class="Symbol">|</a> <a id="2992" class="Symbol">(</a><a id="2993" href="Leios.VRF.html#2993" class="Bound">val</a> <a id="2997" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2999" href="Leios.VRF.html#2999" class="Bound">pf</a><a id="3001" class="Symbol">)</a> <a id="3003" class="Symbol">=</a> <a id="3005" href="Class.Decidable.Core.html#470" class="Function Operator">¿</a> <a id="3007" href="Leios.VRF.html#2993" class="Bound">val</a> <a id="3011" href="Class.HasOrder.Core.html#646" class="Field Operator">&lt;</a> <a id="3013" class="Bound">stake</a> <a id="3019" href="Class.Decidable.Core.html#470" class="Function Operator">¿</a>

  <a id="LeiosVRF.canProduceV2"></a><a id="3024" href="Leios.VRF.html#3024" class="Function">canProduceV2</a> <a id="3037" class="Symbol">:</a> <a id="3039" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="3041" class="Symbol">→</a> <a id="3043" href="Leios.Abstract.html#584" class="Field">PrivKey</a> <a id="3051" class="Symbol">→</a> <a id="3053" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="3055" class="Symbol">→</a> <a id="3057" href="Agda.Primitive.html#388" class="Primitive">Type</a>
  <a id="3064" href="Leios.VRF.html#3024" class="Function">canProduceV2</a> <a id="3077" href="Leios.VRF.html#3077" class="Bound">slot</a> <a id="3082" href="Leios.VRF.html#3082" class="Bound">k</a> <a id="3084" href="Leios.VRF.html#3084" class="Bound">stake</a> <a id="3090" class="Symbol">=</a> <a id="3092" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="3098" class="Symbol">(</a><a id="3099" href="Leios.VRF.html#682" class="Function">eval</a> <a id="3104" href="Leios.VRF.html#3082" class="Bound">k</a> <a id="3106" class="Symbol">(</a><a id="3107" href="Leios.VRF.html#1221" class="Field">genV2Input</a> <a id="3118" href="Leios.VRF.html#3077" class="Bound">slot</a><a id="3122" class="Symbol">))</a> <a id="3125" href="Class.HasOrder.Core.html#646" class="Field Operator">&lt;</a> <a id="3127" href="Leios.VRF.html#3084" class="Bound">stake</a>

  <a id="LeiosVRF.Dec-canProduceV2"></a><a id="3136" href="Leios.VRF.html#3136" class="Function">Dec-canProduceV2</a> <a id="3153" class="Symbol">:</a> <a id="3155" class="Symbol">∀</a> <a id="3157" class="Symbol">{</a><a id="3158" href="Leios.VRF.html#3158" class="Bound">slot</a> <a id="3163" href="Leios.VRF.html#3163" class="Bound">k</a> <a id="3165" href="Leios.VRF.html#3165" class="Bound">stake</a><a id="3170" class="Symbol">}</a> <a id="3172" class="Symbol">→</a> <a id="3174" href="Relation.Nullary.Decidable.Core.html#1966" class="Record">Dec</a> <a id="3178" class="Symbol">(</a><a id="3179" href="Leios.VRF.html#3024" class="Function">canProduceV2</a> <a id="3192" href="Leios.VRF.html#3158" class="Bound">slot</a> <a id="3197" href="Leios.VRF.html#3163" class="Bound">k</a> <a id="3199" href="Leios.VRF.html#3165" class="Bound">stake</a><a id="3204" class="Symbol">)</a>
  <a id="3208" href="Leios.VRF.html#3136" class="Function">Dec-canProduceV2</a> <a id="3225" class="Symbol">{</a><a id="3226" href="Leios.VRF.html#3226" class="Bound">slot</a><a id="3230" class="Symbol">}</a> <a id="3232" class="Symbol">{</a><a id="3233" href="Leios.VRF.html#3233" class="Bound">k</a><a id="3234" class="Symbol">}</a> <a id="3236" class="Symbol">{</a><a id="3237" href="Leios.VRF.html#3237" class="Bound">stake</a><a id="3242" class="Symbol">}</a> <a id="3244" class="Keyword">with</a> <a id="3249" href="Leios.VRF.html#682" class="Function">eval</a> <a id="3254" href="Leios.VRF.html#3233" class="Bound">k</a> <a id="3256" class="Symbol">(</a><a id="3257" href="Leios.VRF.html#1221" class="Field">genV2Input</a> <a id="3268" href="Leios.VRF.html#3226" class="Bound">slot</a><a id="3272" class="Symbol">)</a>
  <a id="3276" class="Symbol">...</a> <a id="3280" class="Symbol">|</a> <a id="3282" class="Symbol">(</a><a id="3283" href="Leios.VRF.html#3283" class="Bound">val</a> <a id="3287" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3289" href="Leios.VRF.html#3289" class="Bound">pf</a><a id="3291" class="Symbol">)</a> <a id="3293" class="Symbol">=</a> <a id="3295" href="Class.Decidable.Core.html#470" class="Function Operator">¿</a> <a id="3297" href="Leios.VRF.html#3283" class="Bound">val</a> <a id="3301" href="Class.HasOrder.Core.html#646" class="Field Operator">&lt;</a> <a id="3303" class="Bound">stake</a> <a id="3309" href="Class.Decidable.Core.html#470" class="Function Operator">¿</a>
</pre>