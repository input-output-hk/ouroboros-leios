!function(){let e,t,n=null;const l=new Map;function i(i){t&&clearTimeout(t),n=i.target;n.getAttribute("data-original-href");const o=n.getAttribute("href");o&&(t=setTimeout((()=>{!async function(t,n){const[i,o]=n.split("#");if(!o)return;let s,a;const d=o.match(/^(B\d+)-L(\d+)$/);if(d)a=d[1],s=parseInt(d[2],10);else{if(!o.startsWith("L"))return;a="B1",s=parseInt(o.substring(1),10)}if(isNaN(s))return;const m=`${i||window.location.pathname}#${a}-${s}`;let p;if(l.has(m))p=l.get(m);else if(i&&i!==window.location.pathname.split("/").pop())try{const e=i.replace(".html","");p=await async function(e,t,n="",l="B1"){try{const i=await fetch(e);if(!i.ok)throw new Error(`Failed to fetch ${e}: ${i.status}`);const o=await i.text(),s=(new DOMParser).parseFromString(o,"text/html"),a=`${l}-LC${t}`,d=s.getElementById(a);if(!d){const e=s.getElementById(`LC${t}`);if(e){const l=e.closest(".code-content");if(l){const i=Array.from(l.querySelectorAll(".code-line")),o=i.indexOf(e);if(-1!==o){const{startIndex:e,endIndex:l,commentLines:s}=c(i,o);return r(i.slice(e,l+1),t,e,n,"B1",s)}}}return null}const m=d.closest(".code-content");if(!m)return null;const p=Array.from(m.querySelectorAll(".code-line")),u=p.indexOf(d);if(-1===u)return null;const{startIndex:h,endIndex:f,commentLines:w}=c(p,u);return r(p.slice(h,f+1),t,h,n,l,w)}catch(i){return console.error("Error fetching preview:",i),null}}(i,s,e,a),p&&l.set(m,p)}catch(u){return void console.error("Error fetching code preview:",u)}else{const e=`${a}-LC${s}`,t=document.getElementById(e);if(!t)return;const n=t.closest(".code-content");if(!n)return;const i=Array.from(n.querySelectorAll(".code-line")),o=i.indexOf(t);if(-1===o)return;const{startIndex:d,endIndex:u,commentLines:h}=c(i,o);p=r(i.slice(d,u+1),s,d,document.title||window.location.pathname.split("/").pop().replace(".html",""),a,h),l.set(m,p)}if(!p)return;e.innerHTML="",e.appendChild(p),function(t){if(!t||!e)return;const n=t.getBoundingClientRect(),l=window.innerWidth,i=window.innerHeight;e.style.maxHeight="",e.style.maxWidth="",e.style.visibility="hidden",e.style.display="block";const o=e.offsetWidth,c=e.offsetHeight;let r=n.bottom+window.scrollY+5,s=n.left+window.scrollX;if(n.bottom+c>i&&(r=n.top+window.scrollY-c-5,r<window.scrollY)){r=window.scrollY+5;const t=i-10;e.style.maxHeight=`${t}px`}s+o>l&&(s=l-o+window.scrollX-5,s<window.scrollX&&(s=window.scrollX+5,e.style.maxWidth=l-10+"px"));e.style.top=`${r}px`,e.style.left=`${s}px`,e.style.visibility="visible"}(t),e.style.display="block"}(n,o)}),300))}function o(){t&&(clearTimeout(t),t=null)}function c(e,t){const n=e=>""===(e.textContent||"").trim(),l=e=>(e.innerHTML||"").includes('class="Comment"'),i=e=>{const t=e.querySelectorAll(".Comment");return 0===t.length?"":Array.from(t).map((e=>e.textContent||"")).join(" ").trim()};let o=Math.max(0,t-3),c=Math.min(e.length-1,t+3),r=[],s=t,a=t;for(;a>0;){if(a--,n(e[a])){let t=a-1,o=[];for(;t>=0&&(l(e[t])||n(e[t]));)l(e[t])&&o.unshift({line:e[t],text:i(e[t])}),t--;o.length>0&&(r=o),s=a+1;break}if(l(e[a])){let t=a,o=[];for(;t>=0&&(l(e[t])||n(e[t]));)l(e[t])&&o.unshift({line:e[t],text:i(e[t])}),t--;o.length>0&&(r=o);let c=a;for(;c<e.length&&(l(e[c])||n(e[c]));)c++;s=c;break}s=a}o=s,a=t;let d=0,m=!1;for(;a<e.length-1&&!m;){const t=e[a].textContent||"";for(const e of t)"("!==e&&"{"!==e&&"["!==e||d++,")"!==e&&"}"!==e&&"]"!==e||d--;if(a++,a<e.length&&d<=0&&(n(e[a])||l(e[a]))){m=!0,c=a-1;break}c=a}return o=Math.max(0,o),c=Math.min(e.length-1,c),{startIndex:o,endIndex:c,commentLines:r}}function r(e,t,n,l="",i="B1",o=[]){const c=document.createElement("div");c.className="code-preview-container";const r=document.createElement("div");r.className="preview-heading";const s=document.createElement("span");s.className="module-name",s.textContent=l?`Definition in ${l}`:"Definition";const a=document.createElement("a");if(a.className="link-to-definition",a.textContent=`Line ${t}`,l&&l!==(document.title||"")?a.href=`${l}.html#${i}-L${t}`:a.href=`#${i}-L${t}`,r.appendChild(s),r.appendChild(a),c.appendChild(r),o.length>0){const e=document.createElement("div");e.className="preview-comment-container";let t="";if(o.forEach(((e,n)=>{let l=e.text.replace(/^\{-\s*/,"").replace(/\s*-\}$/,"").replace(/^\s*\*\s*/,"").trim();t&&l?t+="\n"+l:l&&(t=l)})),t){const n=t.split("\n").map((e=>e.replace(/^\s*\*?\s*/,"").trim())).filter((e=>e.length>0));if(n.length>0){const t=document.createElement("div");t.className="preview-comment-block";let l=null,i=null,o=null;n.forEach((e=>{const n=e.match(/^[-*+]\s+(.+)$/),c=e.match(/^\d+\.\s+(.+)$/);if(n)"ul"!==i&&(l&&t.appendChild(l),l=document.createElement("ul"),l.className="preview-comment-list",i="ul"),o=document.createElement("li"),o.className="preview-comment-list-item",o.textContent=n[1],l.appendChild(o);else if(c)"ol"!==i&&(l&&t.appendChild(l),l=document.createElement("ol"),l.className="preview-comment-list",i="ol"),o=document.createElement("li"),o.className="preview-comment-list-item",o.textContent=c[1],l.appendChild(o);else if(o&&""!==e.trim())o.textContent+=" "+e;else if(l&&(t.appendChild(l),l=null,i=null,o=null),""!==e.trim()){const n=document.createElement("div");n.className="preview-comment-line",n.textContent=e,t.appendChild(n)}})),l&&t.appendChild(l),e.appendChild(t)}}c.appendChild(e)}const d=document.createElement("div");d.className="preview-line-numbers";const m=document.createElement("div");m.className="preview-code-content",e.forEach(((e,l)=>{const i=n+l+1,o=document.createElement("span");o.className="preview-line-number",o.textContent=i,i===t&&o.classList.add("highlight"),d.appendChild(o);const c=document.createElement("div");c.className="preview-code-line",i===t&&c.classList.add("highlight");const r=document.createElement("div");r.style.whiteSpace="pre",r.innerHTML=e.innerHTML,c.appendChild(r),m.appendChild(c)}));const p=document.createElement("div");p.className="Agda";const u=document.createElement("div");return u.className="code-container",u.appendChild(d),u.appendChild(m),p.appendChild(u),c.appendChild(p),c}document.addEventListener("DOMContentLoaded",(function(){!function(){e=document.getElementById("type-preview-container"),e||(e=document.createElement("div"),e.id="type-preview-container",e.className="type-preview-container",e.style.display="none",document.body.appendChild(e));function l(){document.querySelectorAll(".type-hoverable").forEach((e=>{e.addEventListener("mouseenter",i),e.addEventListener("mouseleave",o),e.addEventListener("focus",i),e.addEventListener("blur",o)}))}l(),document.addEventListener("click",(function(l){"block"!==e.style.display||e.contains(l.target)||n?.contains(l.target)||function(){e&&(e.style.display="none");t&&(clearTimeout(t),t=null);n=null}()}))}()}))}();