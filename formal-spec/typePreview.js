!function(){let e,t,n=null;const l=new Map;function i(i){t&&clearTimeout(t),n=i.target;n.getAttribute("data-original-href");const c=n.getAttribute("href");c&&(t=setTimeout((()=>{!async function(t,n){const[i,c]=n.split("#");if(!c)return;let a,s;const d=c.match(/^(B\d+)-L(\d+)$/);if(d)s=d[1],a=parseInt(d[2],10);else{if(!c.startsWith("L"))return;s="B1",a=parseInt(c.substring(1),10)}if(isNaN(a))return;const m=`${i||window.location.pathname}#${s}-${a}`;let p;if(l.has(m))p=l.get(m);else if(i&&i!==window.location.pathname.split("/").pop())try{const e=i.replace(".html","");p=await async function(e,t,n="",l="B1"){try{const i=await fetch(e);if(!i.ok)throw new Error(`Failed to fetch ${e}: ${i.status}`);const c=await i.text(),a=(new DOMParser).parseFromString(c,"text/html"),s=`${l}-LC${t}`,d=a.getElementById(s);if(!d){const e=a.getElementById(`LC${t}`);if(e){const l=e.closest(".code-content");if(l){const i=Array.from(l.querySelectorAll(".code-line")),c=i.indexOf(e);if(-1!==c){const{startIndex:e,endIndex:l,commentLines:a}=o(i,c);return r(i.slice(e,l+1),t,e,n,"B1",a)}}}return null}const m=d.closest(".code-content");if(!m)return null;const p=Array.from(m.querySelectorAll(".code-line")),u=p.indexOf(d);if(-1===u)return null;const{startIndex:h,endIndex:f,commentLines:w}=o(p,u);return r(p.slice(h,f+1),t,h,n,l,w)}catch(i){return console.error("Error fetching preview:",i),null}}(i,a,e,s),p&&l.set(m,p)}catch(u){return void console.error("Error fetching code preview:",u)}else{const e=`${s}-LC${a}`,t=document.getElementById(e);if(!t)return;const n=t.closest(".code-content");if(!n)return;const i=Array.from(n.querySelectorAll(".code-line")),c=i.indexOf(t);if(-1===c)return;const{startIndex:d,endIndex:u,commentLines:h}=o(i,c);p=r(i.slice(d,u+1),a,d,document.title||window.location.pathname.split("/").pop().replace(".html",""),s,h),l.set(m,p)}if(!p)return;e.innerHTML="",e.appendChild(p),function(t){if(!t||!e)return;const n=t.getBoundingClientRect(),l=window.innerWidth,i=window.innerHeight;e.style.maxHeight="",e.style.maxWidth="",e.style.visibility="hidden",e.style.display="block";const c=e.offsetWidth,o=e.offsetHeight;let r=n.bottom+window.scrollY+5,a=n.left+window.scrollX;if(n.bottom+o>i&&(r=n.top+window.scrollY-o-5,r<window.scrollY)){r=window.scrollY+5;const t=i-10;e.style.maxHeight=`${t}px`}a+c>l&&(a=l-c+window.scrollX-5,a<window.scrollX&&(a=window.scrollX+5,e.style.maxWidth=l-10+"px"));e.style.top=`${r}px`,e.style.left=`${a}px`,e.style.visibility="visible"}(t),e.style.display="block"}(n,c)}),300))}function c(){t&&(clearTimeout(t),t=null)}function o(e,t){const n=e=>""===(e.textContent||"").trim(),l=e=>(e.innerHTML||"").includes('class="Comment"'),i=e=>{const t=e.querySelectorAll(".Comment");return 0===t.length?"":Array.from(t).map((e=>e.textContent||"")).join(" ").trim()};let c=Math.max(0,t-3),o=Math.min(e.length-1,t+3),r=[],a=t,s=t;for(;s>0;){if(s--,n(e[s])){a=s+1,r=[];break}if(l(e[s])){let t=s,n=[];for(;t>=0&&l(e[t]);)n.unshift({line:e[t],text:i(e[t])}),t--;n.length>0&&(r=n);let c=s;for(;c<e.length&&l(e[c]);)c++;a=c;break}a=s}c=a,s=t;let d=0,m=!1;for(;s<e.length-1&&!m;){const t=e[s].textContent||"";for(const e of t)"("!==e&&"{"!==e&&"["!==e||d++,")"!==e&&"}"!==e&&"]"!==e||d--;if(s++,s<e.length&&d<=0&&(n(e[s])||l(e[s]))){m=!0,o=s-1;break}o=s}return c=Math.max(0,c),o=Math.min(e.length-1,o),{startIndex:c,endIndex:o,commentLines:r}}function r(e,t,n,l="",i="B1",c=[]){const o=document.createElement("div");o.className="code-preview-container";const r=document.createElement("div");r.className="preview-heading";const a=document.createElement("span");a.className="module-name",a.textContent=l?`Definition in ${l}`:"Definition";const s=document.createElement("a");if(s.className="link-to-definition",s.textContent=`Line ${t}`,l&&l!==(document.title||"")?s.href=`${l}.html#${i}-L${t}`:s.href=`#${i}-L${t}`,r.appendChild(a),r.appendChild(s),o.appendChild(r),c.length>0){const e=document.createElement("div");e.className="preview-comment-container";let t="";if(c.forEach(((e,n)=>{let l=e.text.replace(/^\{-\s*/,"").replace(/\s*-\}$/,"").replace(/^--\s*/,"").replace(/^\s*\*\s*/,"").trim();t&&l?t+="\n"+l:l&&(t=l)})),t){const n=t.split("\n").map((e=>e.replace(/^\s*--\s*/,"").replace(/^\s*\*?\s*/,"").trim())).filter((e=>e.length>0));if(n.length>0){const t=document.createElement("div");t.className="preview-comment-block";let l=null,i=null,c=null,o=!1,r=null;n.forEach((e=>{if(e.toLowerCase().match(/^\s*parameters?\s*:?\s*$/i)){l&&(t.appendChild(l),l=null,i=null,c=null);const e=document.createElement("div");e.className="preview-comment-spacer",t.appendChild(e);const n=document.createElement("div");return n.className="preview-comment-line preview-parameters-heading",n.innerHTML="<strong>Parameters:</strong>",t.appendChild(n),r=document.createElement("table"),r.className="preview-parameters-table",void(o=!0)}const n=e.match(/^[-*+]\s+(.+)$/),a=e.match(/^\d+\.\s+(.+)$/);if(n&&o){const e=n[1],t=e.indexOf(":");if(t>0){const n=e.substring(0,t).trim(),l=e.substring(t+1).trim(),i=document.createElement("tr");i.className="preview-parameter-row";const c=document.createElement("td");c.className="preview-parameter-name",c.textContent=n;const o=document.createElement("td");o.className="preview-parameter-desc",o.textContent=l,i.appendChild(c),i.appendChild(o),r.appendChild(i)}else{const t=document.createElement("tr");t.className="preview-parameter-row";const n=document.createElement("td");n.className="preview-parameter-name",n.textContent=e;const l=document.createElement("td");l.className="preview-parameter-desc",l.textContent="",t.appendChild(n),t.appendChild(l),r.appendChild(t)}}else if(n)o&&r&&(t.appendChild(r),r=null,o=!1),"ul"!==i&&(l&&t.appendChild(l),l=document.createElement("ul"),l.className="preview-comment-list",i="ul"),c=document.createElement("li"),c.className="preview-comment-list-item",c.textContent=n[1],l.appendChild(c);else if(a)o&&r&&(t.appendChild(r),r=null,o=!1),"ol"!==i&&(l&&t.appendChild(l),l=document.createElement("ol"),l.className="preview-comment-list",i="ol"),c=document.createElement("li"),c.className="preview-comment-list-item",c.textContent=a[1],l.appendChild(c);else if(c&&""!==e.trim()&&!o)c.textContent+=" "+e;else if(o&&r&&""!==e.trim()){const t=r.lastElementChild;if(t){const n=t.querySelector(".preview-parameter-desc");n&&(n.textContent+=" "+e)}}else if(o&&r&&(t.appendChild(r),r=null,o=!1),l&&(t.appendChild(l),l=null,i=null,c=null),""!==e.trim()){const n=document.createElement("div");n.className="preview-comment-line",n.textContent=e,t.appendChild(n)}})),l&&t.appendChild(l),o&&r&&t.appendChild(r),e.appendChild(t)}}o.appendChild(e)}const d=document.createElement("div");d.className="preview-line-numbers";const m=document.createElement("div");m.className="preview-code-content",e.forEach(((e,l)=>{const i=n+l+1,c=document.createElement("span");c.className="preview-line-number",c.textContent=i,i===t&&c.classList.add("highlight"),d.appendChild(c);const o=document.createElement("div");o.className="preview-code-line",i===t&&o.classList.add("highlight");const r=document.createElement("div");r.style.whiteSpace="pre",r.innerHTML=e.innerHTML,o.appendChild(r),m.appendChild(o)}));const p=document.createElement("div");p.className="Agda";const u=document.createElement("div");return u.className="code-container",u.appendChild(d),u.appendChild(m),p.appendChild(u),o.appendChild(p),o}document.addEventListener("DOMContentLoaded",(function(){!function(){e=document.getElementById("type-preview-container"),e||(e=document.createElement("div"),e.id="type-preview-container",e.className="type-preview-container",e.style.display="none",document.body.appendChild(e));function l(){document.querySelectorAll(".type-hoverable").forEach((e=>{e.addEventListener("mouseenter",i),e.addEventListener("mouseleave",c),e.addEventListener("focus",i),e.addEventListener("blur",c)}))}l(),document.addEventListener("click",(function(l){"block"!==e.style.display||e.contains(l.target)||n?.contains(l.target)||function(){e&&(e.style.display="none");t&&(clearTimeout(t),t=null);n=null}()}))}()}))}();