!function(){let e=!1,t=[],n={};function s(){const e=window.location.pathname.includes("/formal-spec/")?"/formal-spec/":"/";fetch(e+"search-index-metadata.json").then((e=>{if(e.ok)return e.json();throw new Error("Metadata not found")})).then((t=>{if(t.chunked)return console.log(`Loading chunked search index with ${t.chunks.length} chunks...`),function(e,t){const s=t.chunks.map((t=>fetch(e+`search-index-${t}.json`).then((e=>{if(!e.ok)throw new Error(`Failed to load chunk: ${t}`);return e.json()}))));return Promise.all(s).then((e=>{n={},e.forEach((e=>{Object.assign(n,e)})),console.log(`Chunked search index loaded successfully with ${t.totalEntries} entries from ${t.totalFiles} files`)})).catch((e=>{console.error("Error loading chunked search index:",e)}))}(e,t);throw new Error("Non-chunked metadata found")})).catch((()=>{fetch(e+"search-index.json").then((e=>{if(!e.ok)throw new Error("Failed to load search index");return e.json()})).then((e=>{n=e,console.log("Search index loaded successfully")})).catch((e=>{console.error("Error loading search index:",e)}))}))}function l(e,t){if(!e||!t)return{matched:!1,score:0,highlights:[]};if(e=e.toLowerCase(),(t=t.toLowerCase()).includes(e)){const n=t.indexOf(e),s=Array.from({length:e.length},((e,t)=>n+t));return{matched:!0,score:10+e.length/t.length,highlights:s}}let n=0,s=0;const l=[];let o=-1,r=0;for(let a=0;a<t.length&&!(n>=e.length);a++)t[a]===e[n]&&(o===a-1?(r++,s+=2*r):(r=1,s+=1),o=a,l.push(a),n++);const c=n===e.length;return{matched:c,score:c?s/(.6*t.length):0,highlights:l}}function o(e,t){if(!t||0===t.length)return e;const n=[];let s=[(t=[...t].sort(((e,t)=>e-t)))[0]];for(let o=1;o<t.length;o++)t[o]===t[o-1]+1?s.push(t[o]):(n.push([...s]),s=[t[o]]);s.length>0&&n.push(s);let l=e;for(let o=n.length-1;o>=0;o--){const e=n[o],t=e[0],s=e[e.length-1]+1,r=l.substring(0,t),c=l.substring(t,s),a=l.substring(s);l=r+`<span class="result-match">${c}</span>`+a}return l}document.addEventListener("DOMContentLoaded",(()=>{s();const r=function(){const e=document.createElement("div");e.className="search-overlay",e.style.display="none";const t=document.createElement("div");t.className="search-container";const n=document.createElement("input");n.type="text",n.className="search-input",n.placeholder="Search documentation... (Ctrl+K / Cmd+K)",n.setAttribute("autocomplete","off"),n.setAttribute("autocorrect","off"),n.setAttribute("autocapitalize","off"),n.setAttribute("spellcheck","false");const s=document.createElement("div");return s.className="search-results",s.style.display="none",t.appendChild(n),t.appendChild(s),e.appendChild(t),document.body.appendChild(e),{overlay:e,container:t,input:n,results:s}}(),c=document.querySelector(".header-right");if(c){const e=document.createElement("button");e.className="search-button",e.setAttribute("title","Search documentation (Ctrl+K / Cmd+K)"),e.setAttribute("aria-label","Search documentation"),e.innerHTML='\n        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n          <circle cx="11" cy="11" r="8"></circle>\n          <line x1="21" y1="21" x2="16.65" y2="16.65"></line>\n        </svg>\n      ';const t=c.querySelector(".theme-toggle");t?c.insertBefore(e,t):c.appendChild(e),setTimeout((()=>{c.querySelectorAll("button").forEach((t=>{if(!t.classList.contains("search-button")){const n=Array.from(t.classList).filter((e=>"theme-toggle"!==e));e.classList.add(...n)}}))}),100),e.addEventListener("click",a)}function a(){e=!e,e?(r.overlay.style.display="flex",r.input.focus(),r.results.style.display="none",document.body.classList.add("search-active")):(r.overlay.style.display="none",document.body.classList.remove("search-active"),r.input.value="",r.results.innerHTML="",r.results.style.display="none")}document.addEventListener("keydown",(n=>{if((n.ctrlKey||n.metaKey)&&"k"===n.key&&(n.preventDefault(),a()),"Escape"===n.key&&e&&(n.preventDefault(),a()),e&&t.length>0){const e=r.results.querySelectorAll(".search-result"),s=r.results.querySelector(".search-result.selected");if("ArrowDown"===n.key){n.preventDefault();let t=0;if(s)for(let n=0;n<e.length;n++)if(e[n]===s){t=Math.min(n+1,e.length-1);break}e.forEach((e=>e.classList.remove("selected"))),e[t].classList.add("selected"),e[t].scrollIntoView({behavior:"smooth",block:"nearest"})}else if("ArrowUp"===n.key){n.preventDefault();let t=e.length-1;if(s)for(let n=0;n<e.length;n++)if(e[n]===s){t=Math.max(n-1,0);break}e.forEach((e=>e.classList.remove("selected"))),e[t].classList.add("selected"),e[t].scrollIntoView({behavior:"smooth",block:"nearest"})}else if("Enter"===n.key&&(n.preventDefault(),s)){const e=parseInt(s.getAttribute("data-index"));if(!isNaN(e)&&e>=0&&e<t.length){const n=t[e];a();const s=n.url,l=window.location.pathname.split("#")[0];if(s.startsWith("#")||s.includes("#")&&s.split("#")[0]===l){const e=s.includes("#")?s.split("#")[1]:s.substring(1);window.location.hash=e}else window.location.href=s}}}})),r.overlay.addEventListener("click",(e=>{e.target===r.overlay&&a()})),r.container.addEventListener("click",(e=>{e.stopPropagation()}));let i=null;r.input.addEventListener("input",(e=>{const s=e.target.value.trim();if(i&&clearTimeout(i),!s||s.length<2)return r.results.innerHTML="",r.results.style.display="none",void(t=[]);i=setTimeout((()=>{r.results.innerHTML='<div class="search-loading"><div class="search-loading-spinner"></div></div>',r.results.style.display="block",t=function(e){if(!e||e.length<2||!n||0===Object.keys(n).length)return[];const t=[];for(const[s,o]of Object.entries(n)){const n=s.replace(".html",""),r=l(e,n);r.matched&&t.push({type:"module",moduleName:n,url:s,content:n,score:2*r.score,highlights:r.highlights}),o.forEach((o=>{const r=l(e,o.content);r.matched&&t.push({type:o.type,moduleName:n,url:o.lineNumber?`${s}#L${o.lineNumber}`:s,content:o.content,context:o.context||"",score:r.score,highlights:r.highlights})}))}return t.sort(((e,t)=>t.score-e.score)),t.slice(0,20)}(s),function(e,t,n){if(e.results.innerHTML="",0===t.length){const t=document.createElement("div");return t.className="no-results",t.textContent="No results found",e.results.appendChild(t),void(e.results.style.display="block")}e.results.style.display="block",t.forEach(((t,s)=>{const l=document.createElement("a");if(l.className="search-result",l.setAttribute("data-index",s),l.href=t.url,"code"===t.type){const e=document.createElement("div");if(e.className="result-preview code-preview",t.context){const n=t.context.split("\n");let s="";n.forEach(((e,n)=>{const l=e.toLowerCase().includes(t.content.toLowerCase());s+=l?`<span class="code-highlight">${o(e,t.highlights)}</span>\n`:`<span class="code-context">${e}</span>\n`})),e.innerHTML=s}else e.textContent=t.content;l.appendChild(e)}else{const e=document.createElement("div");e.className="result-title";let n=t.content;if(t.highlights&&(n=o(t.content,t.highlights)),e.innerHTML=n,l.appendChild(e),t.context&&t.context!==t.content){const e=document.createElement("div");e.className="result-preview",t.highlights?e.innerHTML=o(t.context,t.highlights):e.textContent=t.context,l.appendChild(e)}}const r=document.createElement("div");r.className="result-footer";const c=document.createElement("span");c.className="result-path",c.textContent=t.moduleName,r.appendChild(c);const a=document.createElement("span");a.className=`result-type result-type-${t.type}`,a.textContent=t.type,r.appendChild(a),l.appendChild(r),l.addEventListener("click",(s=>{s.preventDefault(),e.results.querySelectorAll(".search-result").forEach((e=>e.classList.remove("selected"))),l.classList.add("selected"),n();const o=t.url,r=window.location.pathname.split("#")[0];if(o.startsWith("#")||o.includes("#")&&o.split("#")[0]===r){const e=o.includes("#")?o.split("#")[1]:o.substring(1);window.location.hash=e}else window.location.href=o})),l.addEventListener("mouseover",(()=>{e.results.querySelectorAll(".search-result").forEach((e=>e.classList.remove("selected"))),l.classList.add("selected")})),e.results.appendChild(l)}))}(r,t,a)}),200)}))}))}();