!function(){let e=!1,t=[],s={};function n(e,t){if(!e||!t)return{matched:!1,score:0,highlights:[]};if(e=e.toLowerCase(),(t=t.toLowerCase()).includes(e)){const s=t.indexOf(e),n=Array.from({length:e.length},((e,t)=>s+t));return{matched:!0,score:10+e.length/t.length,highlights:n}}let s=0,n=0;const l=[];let o=-1,r=0;for(let i=0;i<t.length&&!(s>=e.length);i++)t[i]===e[s]&&(o===i-1?(r++,n+=2*r):(r=1,n+=1),o=i,l.push(i),s++);const c=s===e.length;return{matched:c,score:c?n/(.6*t.length):0,highlights:l}}function l(e,t){if(!t||0===t.length)return e;const s=[];let n=[(t=[...t].sort(((e,t)=>e-t)))[0]];for(let o=1;o<t.length;o++)t[o]===t[o-1]+1?n.push(t[o]):(s.push([...n]),n=[t[o]]);n.length>0&&s.push(n);let l=e;for(let o=s.length-1;o>=0;o--){const e=s[o],t=e[0],n=e[e.length-1]+1,r=l.substring(0,t),c=l.substring(t,n),i=l.substring(n);l=r+`<span class="result-match">${c}</span>`+i}return l}document.addEventListener("DOMContentLoaded",(()=>{!function(){const e=window.location.pathname.includes("/formal-spec/")?"/formal-spec/search-index.json":"/search-index.json";fetch(e).then((e=>{if(!e.ok)throw new Error("Failed to load search index");return e.json()})).then((e=>{s=e,console.log("Search index loaded successfully")})).catch((e=>{console.error("Error loading search index:",e)}))}();const o=function(){const e=document.createElement("div");e.className="search-overlay",e.style.display="none";const t=document.createElement("div");t.className="search-container";const s=document.createElement("input");s.type="text",s.className="search-input",s.placeholder="Search documentation... (Ctrl+K / Cmd+K)",s.setAttribute("autocomplete","off"),s.setAttribute("autocorrect","off"),s.setAttribute("autocapitalize","off"),s.setAttribute("spellcheck","false");const n=document.createElement("div");return n.className="search-results",n.style.display="none",t.appendChild(s),t.appendChild(n),e.appendChild(t),document.body.appendChild(e),{overlay:e,container:t,input:s,results:n}}(),r=document.querySelector(".header-right");if(r){const e=document.createElement("button");e.className="search-button",e.setAttribute("title","Search documentation (Ctrl+K / Cmd+K)"),e.setAttribute("aria-label","Search documentation"),e.innerHTML='\n        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n          <circle cx="11" cy="11" r="8"></circle>\n          <line x1="21" y1="21" x2="16.65" y2="16.65"></line>\n        </svg>\n      ';const t=r.querySelector(".theme-toggle");t?r.insertBefore(e,t):r.appendChild(e),setTimeout((()=>{r.querySelectorAll("button").forEach((t=>{if(!t.classList.contains("search-button")){const s=Array.from(t.classList).filter((e=>"theme-toggle"!==e));e.classList.add(...s)}}))}),100),e.addEventListener("click",c)}function c(){e=!e,e?(o.overlay.style.display="flex",o.input.focus(),o.results.style.display="none",document.body.classList.add("search-active")):(o.overlay.style.display="none",document.body.classList.remove("search-active"),o.input.value="",o.results.innerHTML="",o.results.style.display="none")}document.addEventListener("keydown",(s=>{if((s.ctrlKey||s.metaKey)&&"k"===s.key&&(s.preventDefault(),c()),"Escape"===s.key&&e&&(s.preventDefault(),c()),e&&t.length>0){const e=o.results.querySelectorAll(".search-result"),n=o.results.querySelector(".search-result.selected");if("ArrowDown"===s.key){s.preventDefault();let t=0;if(n)for(let s=0;s<e.length;s++)if(e[s]===n){t=Math.min(s+1,e.length-1);break}e.forEach((e=>e.classList.remove("selected"))),e[t].classList.add("selected"),e[t].scrollIntoView({behavior:"smooth",block:"nearest"})}else if("ArrowUp"===s.key){s.preventDefault();let t=e.length-1;if(n)for(let s=0;s<e.length;s++)if(e[s]===n){t=Math.max(s-1,0);break}e.forEach((e=>e.classList.remove("selected"))),e[t].classList.add("selected"),e[t].scrollIntoView({behavior:"smooth",block:"nearest"})}else if("Enter"===s.key&&(s.preventDefault(),n)){const e=parseInt(n.getAttribute("data-index"));if(!isNaN(e)&&e>=0&&e<t.length){const s=t[e];c();const n=s.url,l=window.location.pathname.split("#")[0];if(n.startsWith("#")||n.includes("#")&&n.split("#")[0]===l){const e=n.includes("#")?n.split("#")[1]:n.substring(1);window.location.hash=e}else window.location.href=n}}}})),o.overlay.addEventListener("click",(e=>{e.target===o.overlay&&c()})),o.container.addEventListener("click",(e=>{e.stopPropagation()}));let i=null;o.input.addEventListener("input",(e=>{const r=e.target.value.trim();if(i&&clearTimeout(i),!r||r.length<2)return o.results.innerHTML="",o.results.style.display="none",void(t=[]);i=setTimeout((()=>{o.results.innerHTML='<div class="search-loading"><div class="search-loading-spinner"></div></div>',o.results.style.display="block",t=function(e){if(!e||e.length<2||!s||0===Object.keys(s).length)return[];const t=[];for(const[l,o]of Object.entries(s)){const s=l.replace(".html",""),r=n(e,s);r.matched&&t.push({type:"module",moduleName:s,url:l,content:s,score:2*r.score,highlights:r.highlights}),o.forEach((o=>{const r=n(e,o.content);r.matched&&t.push({type:o.type,moduleName:s,url:o.lineNumber?`${l}#L${o.lineNumber}`:l,content:o.content,context:o.context||"",score:r.score,highlights:r.highlights})}))}return t.sort(((e,t)=>t.score-e.score)),t.slice(0,20)}(r),function(e,t,s){if(e.results.innerHTML="",0===t.length){const t=document.createElement("div");return t.className="no-results",t.textContent="No results found",e.results.appendChild(t),void(e.results.style.display="block")}e.results.style.display="block",t.forEach(((t,n)=>{const o=document.createElement("a");if(o.className="search-result",o.setAttribute("data-index",n),o.href=t.url,"code"===t.type){const e=document.createElement("div");if(e.className="result-preview code-preview",t.context){const s=t.context.split("\n");let n="";s.forEach(((e,s)=>{const o=e.toLowerCase().includes(t.content.toLowerCase());n+=o?`<span class="code-highlight">${l(e,t.highlights)}</span>\n`:`<span class="code-context">${e}</span>\n`})),e.innerHTML=n}else e.textContent=t.content;o.appendChild(e)}else{const e=document.createElement("div");e.className="result-title";let s=t.content;if(t.highlights&&(s=l(t.content,t.highlights)),e.innerHTML=s,o.appendChild(e),t.context&&t.context!==t.content){const e=document.createElement("div");e.className="result-preview",t.highlights?e.innerHTML=l(t.context,t.highlights):e.textContent=t.context,o.appendChild(e)}}const r=document.createElement("div");r.className="result-footer";const c=document.createElement("span");c.className="result-path",c.textContent=t.moduleName,r.appendChild(c);const i=document.createElement("span");i.className=`result-type result-type-${t.type}`,i.textContent=t.type,r.appendChild(i),o.appendChild(r),o.addEventListener("click",(n=>{n.preventDefault(),e.results.querySelectorAll(".search-result").forEach((e=>e.classList.remove("selected"))),o.classList.add("selected"),s();const l=t.url,r=window.location.pathname.split("#")[0];if(l.startsWith("#")||l.includes("#")&&l.split("#")[0]===r){const e=l.includes("#")?l.split("#")[1]:l.substring(1);window.location.hash=e}else window.location.href=l})),o.addEventListener("mouseover",(()=>{e.results.querySelectorAll(".search-result").forEach((e=>e.classList.remove("selected"))),o.classList.add("selected")})),e.results.appendChild(o)}))}(o,t,c)}),200)}))}))}();